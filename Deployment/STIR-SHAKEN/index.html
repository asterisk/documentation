<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://docs.asterisk.org/Deployment/STIR-SHAKEN/ rel=canonical><link href=../Reference-Use-Cases-for-Asterisk/Super-Awesome-Company/ rel=prev><link href=../Secure-Calling/ rel=next><link rel=icon href=../../favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.19"><title>STIR-SHAKEN - Asterisk Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../material-override.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2ZKMCW9DZ9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2ZKMCW9DZ9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2ZKMCW9DZ9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#stir-shaken class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Asterisk Documentation" class="md-header__button md-logo" aria-label="Asterisk Documentation" data-md-component=logo> <img src=../../favicon.ico alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Asterisk Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> STIR-SHAKEN </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <table border=0 style="width: max-content;padding:0px;margin:0px"><tr><td> <a href=https://github.com/asterisk/asterisk title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Asterisk </div> </a> </td> <td style=font-size:.65rem;line-height:1.2;vertical-align:middle;> <a href=/About-the-Project/Asterisk-Versions>Asterisk Versions</a><br> <a target=_blank href=https://github.com/asterisk/documentation/issues>Report Documentation Issues</a><br> <a target=_blank href=https://github.com/asterisk/documentation>Contribute to the Documentation</a> </td></tr> </table> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Asterisk Documentation" class="md-nav__button md-logo" aria-label="Asterisk Documentation" data-md-component=logo> <img src=../../favicon.ico alt=logo> </a> Asterisk Documentation </label> <div class=md-nav__source> <table border=0 style="width: max-content;padding:0px;margin:0px"><tr><td> <a href=https://github.com/asterisk/asterisk title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Asterisk </div> </a> </td> <td style=font-size:.65rem;line-height:1.2;vertical-align:middle;> <a href=/About-the-Project/Asterisk-Versions>Asterisk Versions</a><br> <a target=_blank href=https://github.com/asterisk/documentation/issues>Report Documentation Issues</a><br> <a target=_blank href=https://github.com/asterisk/documentation>Contribute to the Documentation</a> </td></tr> </table> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../About-the-Project/ class=md-nav__link> <span class=md-ellipsis> About the Project </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-Community/ class=md-nav__link> <span class=md-ellipsis> Asterisk Community </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Fundamentals/ class=md-nav__link> <span class=md-ellipsis> Fundamentals </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Getting-Started/Beginning-Asterisk/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Deployment </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Deployment-In-Your-Network/ class=md-nav__link> <span class=md-ellipsis> Deployment In Your Network </span> </a> </li> <li class=md-nav__item> <a href=../Emergency-Calling/ class=md-nav__link> <span class=md-ellipsis> Emergency Calling </span> </a> </li> <li class=md-nav__item> <a href=../IPv6-Support/ class=md-nav__link> <span class=md-ellipsis> IPv6 Support </span> </a> </li> <li class=md-nav__item> <a href=../Performance-Tuning/ class=md-nav__link> <span class=md-ellipsis> Performance Tuning </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Asterisk-Security-Framework/ class=md-nav__link> <span class=md-ellipsis> Asterisk Security Framework </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Basic-PBX-Functionality/ class=md-nav__link> <span class=md-ellipsis> Basic PBX Functionality </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Distributed-Universal-Number-Discovery-DUNDi/ class=md-nav__link> <span class=md-ellipsis> Distributed Universal Number Discovery DUNDi </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Enhanced-Messaging/ class=md-nav__link> <span class=md-ellipsis> Enhanced Messaging </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Geolocation/ class=md-nav__link> <span class=md-ellipsis> Geolocation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Important-Security-Considerations/ class=md-nav__link> <span class=md-ellipsis> Important Security Considerations </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Internationalization-and-Localization/ class=md-nav__link> <span class=md-ellipsis> Internationalization and Localization </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Media-Experience-Score/ class=md-nav__link> <span class=md-ellipsis> Media Experience Score </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../PSTN-Connectivity/ class=md-nav__link> <span class=md-ellipsis> PSTN Connectivity </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Packet-Loss-Concealment-PLC/ class=md-nav__link> <span class=md-ellipsis> Packet Loss Concealment PLC </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Phone-Provisioning-in-Asterisk/ class=md-nav__link> <span class=md-ellipsis> Phone Provisioning in Asterisk </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Privacy-Configuration/ class=md-nav__link> <span class=md-ellipsis> Privacy Configuration </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Reference-Use-Cases-for-Asterisk/ class=md-nav__link> <span class=md-ellipsis> Reference Use Cases for Asterisk </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_19 checked> <div class="md-nav__link md-nav__container"> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> STIR SHAKEN </span> </a> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_19_label aria-expanded=true> <label class=md-nav__title for=__nav_6_19> <span class="md-nav__icon md-icon"></span> STIR SHAKEN </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Secure-Calling/ class=md-nav__link> <span class=md-ellipsis> Secure Calling </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Troubleshooting/SIP-Retransmissions/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Operation/ class=md-nav__link> <span class=md-ellipsis> Operation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Development/ class=md-nav__link> <span class=md-ellipsis> Development </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Latest_API/ class=md-nav__link> <span class=md-ellipsis> Latest API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk_18_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 18 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk_19_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 19 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk_20_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 20 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk_21_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 21 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk_22_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 22 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk_23_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 23 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Certified-Asterisk_18.9_Documentation/ class=md-nav__link> <span class=md-ellipsis> Certified Asterisk 18.9 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Certified-Asterisk_20.7_Documentation/ class=md-nav__link> <span class=md-ellipsis> Certified Asterisk 20.7 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Test-Suite-Documentation/ class=md-nav__link> <span class=md-ellipsis> Test Suite Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Historical-Documentation/ class=md-nav__link> <span class=md-ellipsis> Historical Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../Contributing-to-the-Documentation/ class=md-nav__link> <span class=md-ellipsis> Contributing to the Documentation </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#stir-shaken-services class=md-nav__link> <span class=md-ellipsis> STIR-SHAKEN Services </span> </a> <nav class=md-nav aria-label="STIR-SHAKEN Services"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#attestation class=md-nav__link> <span class=md-ellipsis> Attestation </span> </a> </li> <li class=md-nav__item> <a href=#verification class=md-nav__link> <span class=md-ellipsis> Verification </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#asterisk-implementation class=md-nav__link> <span class=md-ellipsis> Asterisk Implementation </span> </a> <nav class=md-nav aria-label="Asterisk Implementation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> <nav class=md-nav aria-label=Configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#attestation-object class=md-nav__link> <span class=md-ellipsis> Attestation Object </span> </a> <nav class=md-nav aria-label="Attestation Object"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#global_disable class=md-nav__link> <span class=md-ellipsis> global_disable </span> </a> </li> <li class=md-nav__item> <a href=#private_key_file class=md-nav__link> <span class=md-ellipsis> private_key_file </span> </a> </li> <li class=md-nav__item> <a href=#public_cert_url class=md-nav__link> <span class=md-ellipsis> public_cert_url </span> </a> </li> <li class=md-nav__item> <a href=#check_tn_cert_public_url class=md-nav__link> <span class=md-ellipsis> check_tn_cert_public_url </span> </a> </li> <li class=md-nav__item> <a href=#attest_level class=md-nav__link> <span class=md-ellipsis> attest_level </span> </a> </li> <li class=md-nav__item> <a href=#send_mky class=md-nav__link> <span class=md-ellipsis> send_mky </span> </a> </li> <li class=md-nav__item> <a href=#example-attestation-object class=md-nav__link> <span class=md-ellipsis> Example "attestation" object: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#tn-object class=md-nav__link> <span class=md-ellipsis> TN Object </span> </a> <nav class=md-nav aria-label="TN Object"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#type-required class=md-nav__link> <span class=md-ellipsis> type (required) </span> </a> </li> <li class=md-nav__item> <a href=#private_key_file_1 class=md-nav__link> <span class=md-ellipsis> private_key_file </span> </a> </li> <li class=md-nav__item> <a href=#public_cert_url_1 class=md-nav__link> <span class=md-ellipsis> public_cert_url </span> </a> </li> <li class=md-nav__item> <a href=#attest_level_1 class=md-nav__link> <span class=md-ellipsis> attest_level </span> </a> </li> <li class=md-nav__item> <a href=#example-tn-object class=md-nav__link> <span class=md-ellipsis> Example "tn" object: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#verification-object class=md-nav__link> <span class=md-ellipsis> Verification Object </span> </a> <nav class=md-nav aria-label="Verification Object"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#global_disable_1 class=md-nav__link> <span class=md-ellipsis> global_disable </span> </a> </li> <li class=md-nav__item> <a href=#load_system_certs class=md-nav__link> <span class=md-ellipsis> load_system_certs </span> </a> </li> <li class=md-nav__item> <a href=#ca_file class=md-nav__link> <span class=md-ellipsis> ca_file </span> </a> </li> <li class=md-nav__item> <a href=#ca_path class=md-nav__link> <span class=md-ellipsis> ca_path </span> </a> </li> <li class=md-nav__item> <a href=#crl_file class=md-nav__link> <span class=md-ellipsis> crl_file </span> </a> </li> <li class=md-nav__item> <a href=#crl_path class=md-nav__link> <span class=md-ellipsis> crl_path </span> </a> </li> <li class=md-nav__item> <a href=#untrusted_cert_file class=md-nav__link> <span class=md-ellipsis> untrusted_cert_file </span> </a> </li> <li class=md-nav__item> <a href=#untrusted_cert_path class=md-nav__link> <span class=md-ellipsis> untrusted_cert_path </span> </a> </li> <li class=md-nav__item> <a href=#cert_cache_dir class=md-nav__link> <span class=md-ellipsis> cert_cache_dir </span> </a> </li> <li class=md-nav__item> <a href=#curl_timeout class=md-nav__link> <span class=md-ellipsis> curl_timeout </span> </a> </li> <li class=md-nav__item> <a href=#max_cache_entry_age class=md-nav__link> <span class=md-ellipsis> max_cache_entry_age </span> </a> </li> <li class=md-nav__item> <a href=#max_cache_size class=md-nav__link> <span class=md-ellipsis> max_cache_size </span> </a> </li> <li class=md-nav__item> <a href=#max_iat_age class=md-nav__link> <span class=md-ellipsis> max_iat_age </span> </a> </li> <li class=md-nav__item> <a href=#max_date_header_age class=md-nav__link> <span class=md-ellipsis> max_date_header_age </span> </a> </li> <li class=md-nav__item> <a href=#failure_action class=md-nav__link> <span class=md-ellipsis> failure_action </span> </a> </li> <li class=md-nav__item> <a href=#use_rfc9410_responses class=md-nav__link> <span class=md-ellipsis> use_rfc9410_responses </span> </a> </li> <li class=md-nav__item> <a href=#relax_x5u_port_scheme_restrictions class=md-nav__link> <span class=md-ellipsis> relax_x5u_port_scheme_restrictions </span> </a> </li> <li class=md-nav__item> <a href=#relax_x5u_path_restrictions class=md-nav__link> <span class=md-ellipsis> relax_x5u_path_restrictions </span> </a> </li> <li class=md-nav__item> <a href=#x5u_permitx5u_deny class=md-nav__link> <span class=md-ellipsis> x5u_permit/x5u_deny </span> </a> </li> <li class=md-nav__item> <a href=#x5u_acl class=md-nav__link> <span class=md-ellipsis> x5u_acl </span> </a> </li> <li class=md-nav__item> <a href=#example-verification-object class=md-nav__link> <span class=md-ellipsis> Example "verification" object: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#profile-object class=md-nav__link> <span class=md-ellipsis> Profile Object </span> </a> <nav class=md-nav aria-label="Profile Object"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#type class=md-nav__link> <span class=md-ellipsis> type </span> </a> </li> <li class=md-nav__item> <a href=#endpoint_behhavior class=md-nav__link> <span class=md-ellipsis> endpoint_behhavior </span> </a> </li> <li class=md-nav__item> <a href=#example-profile-object class=md-nav__link> <span class=md-ellipsis> Example "profile" object: </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#incoming-call-flow class=md-nav__link> <span class=md-ellipsis> Incoming Call Flow </span> </a> </li> <li class=md-nav__item> <a href=#outgoing-call-flow class=md-nav__link> <span class=md-ellipsis> Outgoing Call Flow </span> </a> </li> <li class=md-nav__item> <a href=#certificate-and-crl-notes class=md-nav__link> <span class=md-ellipsis> Certificate and CRL Notes </span> </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=stir-shaken>STIR-SHAKEN<a class=headerlink href=#stir-shaken title="Permanent link">&para;</a></h1> <p>This document refers to the Stir/Shaken Refactor of 1Q2024. The earlier version was only partially functional and not interoperable with other implementations.</p> <h2 id=stir-shaken-services>STIR-SHAKEN Services<a class=headerlink href=#stir-shaken-services title="Permanent link">&para;</a></h2> <p>There are 2 services associated with STIR-SHAKEN call processing implementations...</p> <h3 id=attestation>Attestation<a class=headerlink href=#attestation title="Permanent link">&para;</a></h3> <p>On an outbound call, attestation is basically you swearing in court what level of responsibility you have over the accuracy of the caller id you're presenting in the outgoing INVITE message, where the level can be one of the following:</p> <ul> <li><strong>A</strong>: Full Attestation<ul> <li>You are responsible for the origination of the call onto the IP-based service provider voice network.</li> <li>You have a direct authenticated relationship with the customer and can identify the customer.</li> <li>You have established a verified association with the telephone number used for the call.</li> </ul> </li> <li><strong>B</strong>: Partial Attestation<ul> <li>You are responsible for the origination of the call onto the IP-based service provider voice network.</li> <li>You have a direct authenticated relationship with the customer and can identify the customer.</li> <li>BUT you have NOT established a verified association with the telephone number used for the call.</li> </ul> </li> <li><strong>C</strong>: Gateway Attestation<ul> <li>You're clueless. You're just passing the call along.</li> </ul> </li> </ul> <p>Attestation is accomplished by adding a SIP "Identity" header to the outgoing INVITE whose contents are signed with a specific private key/certificate which can be traced back to the actual caller id's owning service provider. For most Asterisk installation scenarios, you'd receive such a key/certificate from your upstream service provider when they issue you DID telephone numbers. Parameters that must be placed in the header include...</p> <ul> <li>The caller-id, even though it's probably already in the P-Asserted-Identity or From SIP headers.</li> <li>The attestation level.</li> <li>The date.</li> <li>The destination telephone number.</li> <li>A URL to the certificate whose private key was used to sign this header.</li> <li>The signature that resulted from signing the header with the associated private key.</li> </ul> <h3 id=verification>Verification<a class=headerlink href=#verification title="Permanent link">&para;</a></h3> <p>This is the hard part... When you receive an incoming INVITE containing an Identity header, you can't just automatically trust it. There are a very specific set of tests that must be executed to determine if the information in that Identity header is valid. Most of these tests are described in <a href=https://access.atis.org/higherlogic/ws/public/download/67436/ATIS-1000074.v003.pdf>ATIS-1000074v003</a> * The certificate URL included in the Identity header must use the https scheme, must not have any query parameters, user/password components, or path parameters. The hostname part of the URL must also NOT resolve to any of the Special-Purpose IP Addresses described in <a href=https://datatracker.ietf.org/doc/html/rfc6890>RFC-6890</a> which includes the local interface 127.0.0.x and the private networks like 10.0.0.0/8, 172.16.0.0/12 and 192.168.0.0/16. Don't worry, for testing purposes you can relax these restrictions. :)</p> <ul> <li>The verifier must retrieve the certificate using the URL referenced in the Identity header.</li> <li>The certificate's valid times must encompass the current time.</li> <li>The certificate must be traceable back to a certificate authority that is trusted to issue certificates for the telephone number in question.</li> <li>The certificate must contain an X509v3 CRL Distribution Points extension with a URI to the issuer's certificate revocation list.</li> <li>The certificate must not be in the CRL.</li> <li>The certificate must have a special TNAuthList extension.</li> <li>The TNAuthList extension must contain a Service Provider Code(SPC)</li> <li>The certificate's Subject commonName(CN) must be in the format "SHAKEN <spc>".</li> <li>The SPC in the TNAuthList extension must match the SPC in the CN.</li> <li>The public key attached to the retrieved certificate must be able to decrypt the signature on the Identity header. This ensures that that certificate's private key was the one that created the signature.</li> <li>The "iat" date parameter in the header must be within a few seconds of "now".</li> <li>The SIP Date header must be present and also within a few seconds of "now".</li> <li>The caller-id in the Identity header must match the caller-id in the P-Asserted-Identity or From SIP headers.</li> </ul> <p>If any of the checks fail, the specifications say you MUST... <em>do absolutely nothing</em>. You <em>may</em> however do one of the following:</p> <ul> <li>Accept the call and continue as if nothing happened.</li> <li>Accept the call but return some data back to the sender with some error information that may be useful to them. What they do with it is their business.</li> <li>Reject the call with very specific 4XX response codes.</li> </ul> <div class="admonition warning"> <p class=admonition-title>Deviations from Specifications</p> <ul> <li>At the present time, Asterisk does not validate the destination TN in the SIP "To:" and the "dest" TN in the Identity header. The rules for doing so are fairly complex with regard to emergency services numbers and call diversion (forwarding, transfer, etc).</li> <li>Although <a href=https://www.rfc-editor.org/rfc/rfc8225#section-7>RFC-8225 section 7</a> allows the use of the compact form of the PASSporT, <a href=https://access.atis.org/higherlogic/ws/public/download/67436/ATIS-1000074.v003.pdf/latest>ATIS-1000074</a> section 5.3.3 states that only the full form shall be used. Asterisk therefore supports only the full form of the PASSporT.</li> <li>Asterisk currently performs only basic validation of certificates retrieved during the verification process. Certificate authority, validity date and TNAuthList extension presence are validated but validation of the Common Name content is not performed. Also, the certificate is only checked against CRLs previously downloaded and configured in stir_shaken.conf. No attempt to retrieve or use the CRL indicated in the certificate's X509v3 CRL Distribution Points extension because the only real-world certificate we could find to test with has a bad URI.</li> </ul> </div> <div class="admonition warning"> <p class=admonition-title>Telephone Number to Service Provider validation is not possible!</p> <p>Although <a href=https://www.rfc-editor.org/rfc/rfc8226#section-9>RFC-8226 section 9</a> states that the TNAuthList extension can contain a service provider code, a telephone number, or a range of telephone numbers, <a href=https://access.atis.org/higherlogic/ws/public/download/69428/ATIS-1000080.v005.pdf/latest>ATIS-1000080</a> section 6.4.1.2 states "The TNAuthList shall contain a single SPC value.". Asterisk therefore will fail to verify a certificate whose TNAuthList extension contains something other than an SPC code.</p> <p>It was apparently envisioned that a facility would be made available to verify that a particular SPC has the authority over a particular telephone number. To our knowledge, that facility doesn't yet exist. This means that there is currently no way for Asterisk to verify that the SPC in the certificate has the authority over the TN in the Identity header.</p> </div> <h2 id=asterisk-implementation>Asterisk Implementation<a class=headerlink href=#asterisk-implementation title="Permanent link">&para;</a></h2> <h3 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h3> <p>All configuration is done via the stir_shaken.conf file. The sample <a href=https://github.com/asterisk/asterisk/raw/master/configs/samples/stir_shaken.conf.sample>stir_shaken.conf</a> is heavily commented.</p> <p>There are 4 object types used by the STIR/SHAKEN process...</p> <p>The "attestation" object sets the parameters for creating an Identity header which attests to the ownership of the caller id on outgoing INVITE requests.</p> <p>One or more "tn" objects that are used to create the outgoing Identity header. Each object's "id" is a specific caller-id telephone number and the object contains the URL to the certificate that was used to attest to the ownership of the caller-id, the level (A,B,C) of the attestation you're making, and the private key the asterisk attestation service will use to sign the Identity header. When an outgoing INVITE request is placed, the attestation service will look up the caller-id in the tn object list and if it's found, use the information in the object to create the Identity header.</p> <p>The "verification" object sets the parameters for verification of the Identity header and caller id on incoming INVITE requests.</p> <p>One or more "profile" objects that can be associated to channel driver endpoints (currently only chan_pjsip). Profiles can set whether verification, attestation, both or neither should be performed on requests coming in to this endpoint or requests going out from this endpoint. Additionally they can override most of the attestation and verification options to make them specific to an endpoint. When Asterisk loads the configs, it creates "effective profiles" or "eprofiles" on the fly that are the amalgamation of the attestation, verification and profile. You can see them in the CLI with "stir_shaken show eprofiles".</p> <p>NOTE: The "tn" object can be configured to source its data from a realtime database by configuring sorcery.conf and extconfig.conf. Both of those files have examples for "stir_tn". There is also an Alembic script in the "config" section of contrib/ast-db-manage that will create the table. Since there can be only one "verification" or "attestation" object, and will probably be only a few "profile" objects, those objects aren't realtime enabled.</p> <h4 id=attestation-object>Attestation Object<a class=headerlink href=#attestation-object title="Permanent link">&para;</a></h4> <p>The "attestation" object sets the parameters for creating an Identity header which attests to the ownership of the caller id on outgoing INVITE requests.</p> <p>All parameters except 'global_disable" may be overridden in a "profile" or "tn" object.</p> <p>Only one "attestation" object may exist. If it doesn't exist at all, the attestation service is globally disabled.</p> <p>Parameters:</p> <h5 id=global_disable>global_disable<a class=headerlink href=#global_disable title="Permanent link">&para;</a></h5> <p>If set, globally disables the attestation service. No Identity headers will be added to any outgoing INVITE requests.</p> <p>Default: no</p> <h5 id=private_key_file>private_key_file<a class=headerlink href=#private_key_file title="Permanent link">&para;</a></h5> <p>The path to a file containing the private key you received from the issuing authority. The file must NOT be group or world readable or writable so make sure the user the asterisk process is running as is the owner.</p> <p>Default: none</p> <h5 id=public_cert_url>public_cert_url<a class=headerlink href=#public_cert_url title="Permanent link">&para;</a></h5> <p>The URL to the certificate you received from the issueing authority. They may give you a URL to use or you may have to host the certificate yourself and provide your own URL here.</p> <p>Default: none</p> <p>WARNING: Make absolutely sure the file that's made public doesn't accidentally include the privite key as well as the certificate. If you set "check_tn_cert_public_url" in the "attestation" section above, the tn will not be loaded and a "DANGER" message will be output on the asterisk console if the file does contain a private key.</p> <h5 id=check_tn_cert_public_url>check_tn_cert_public_url<a class=headerlink href=#check_tn_cert_public_url title="Permanent link">&para;</a></h5> <p>Identity headers in outgoing requests must contain a URL that points to the certificate used to sign the header. Setting this parameter tells Asterisk to actually try to retrieve the certificates indicated by "public_cert_url" parameters and fail loading that tn if the cert can't be retrieved or if its 'Not Valid Before" -&gt; 'Not Valid After" date range doesn't include today. This is a network intensive process so use with caution.</p> <p>Default: no</p> <h5 id=attest_level>attest_level<a class=headerlink href=#attest_level title="Permanent link">&para;</a></h5> <p>The level of the attestation you're making. One of "A", "B", "C"</p> <p>Default: none</p> <h5 id=send_mky>send_mky<a class=headerlink href=#send_mky title="Permanent link">&para;</a></h5> <p>If set and an outgoing call uses DTLS, an "mky" Media Key grant will be added to the Identity header. Although RFC8224/8225 require this, not many implementations support it so a remote verification service may fail to verify the signature.</p> <p>Default: no</p> <h5 id=example-attestation-object>Example "attestation" object:<a class=headerlink href=#example-attestation-object title="Permanent link">&para;</a></h5> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>[attestation]
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>global_disable = no
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>private_key_file = /var/lib/asterisk/keys/stir_shaken/tns/multi-tns-key.pem
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>public_cert_url = https://example.com/tncerts/multi-tns-cert.pem
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>attest_level = C
</span></code></pre></div> <h4 id=tn-object>TN Object<a class=headerlink href=#tn-object title="Permanent link">&para;</a></h4> <p>Each "tn" object contains the parameters needed to create the Identity header used to attest to the ownership of the caller-id on outgoing requests. When an outgoing INVITE request is placed, the attestation service will look up the caller-id in this list and if it's found, use the information in the object to create the Identity header. The private key and certificate needed to sign the Identity header are usually provided to you by the telephone number issuing authority along with their certificate authority certificate. You should give the CA certificate to any recipients who expect to receive calls from you although this has probably already been done by the issuing authority.</p> <p>The "id" of this object MUST be a canonicalized telephone nmumber which starts with a country code. The only valid characters are the numbers 0-9, '#' and '*'. With the 18.23.0, 20.8.0 and 21.3.0 releases of Asterisk, caller-ids are canonicalized before searching for "tn" objects. Previously, caller-ids had to match "tn" ids exactly.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The STIR-SHAKEN subsystem takes "caller-id" from the channel exactly like the <code>CALLERID(num)</code> dialplan function. If you create or modify outgoing SIP headers like <code>From</code> or <code>P-Asserted-Identity</code> and they don't match what's on the channel, the information in the outgoing Identity header won't match the the headers. This may cause the remote end to fail to validate your attestation.</p> </div> <p>The default values for all of the "tn" parameters come from the "<a href=#attestation-object>attestation</a>" and "<a href=#profile-object>profile</a>" objects.</p> <p>Parameters:</p> <h5 id=type-required>type (required)<a class=headerlink href=#type-required title="Permanent link">&para;</a></h5> <p>Must be set to "tn"</p> <p>Default: none</p> <h5 id=private_key_file_1>private_key_file<a class=headerlink href=#private_key_file_1 title="Permanent link">&para;</a></h5> <p>See the description under <a href=#attestation-object>attestation</a></p> <h5 id=public_cert_url_1>public_cert_url<a class=headerlink href=#public_cert_url_1 title="Permanent link">&para;</a></h5> <p>See the description and WARNING under <a href=#attestation-object>attestation</a></p> <h5 id=attest_level_1>attest_level<a class=headerlink href=#attest_level_1 title="Permanent link">&para;</a></h5> <p>See the description under <a href=#attestation-object>attestation</a></p> <h5 id=example-tn-object>Example "tn" object:<a class=headerlink href=#example-tn-object title="Permanent link">&para;</a></h5> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>[18005551515]
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>type = tn
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>private_key_file = /var/lib/asterisk/keys/stir_shaken/tns/18005551515-key.pem
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>public_cert_url = https://example.com/tncerts/18005551515-cert.pem
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>attest_level = C
</span></code></pre></div> Using all the attestation and profile defaults:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>[18005551515]
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>type = tn
</span></code></pre></div> <h4 id=verification-object>Verification Object<a class=headerlink href=#verification-object title="Permanent link">&para;</a></h4> <p>The "verification" object sets the parameters for verification of the Identity header on incoming INVITE requests.</p> <p>All parameters except 'global_disable" may be overridden in a "profile" object.</p> <p>Only one "verification" object may exist. If it doesn't exist at all, the verification service is globally disabled.</p> <p>Parameters:</p> <h5 id=global_disable_1>global_disable<a class=headerlink href=#global_disable_1 title="Permanent link">&para;</a></h5> <p>If set, globally disables the verification service.</p> <p>Default: no</p> <h5 id=load_system_certs>load_system_certs<a class=headerlink href=#load_system_certs title="Permanent link">&para;</a></h5> <p>If set, loads the system Certificate Authority certificates (usually located in /etc/pki/CA) into the trust store used to validate the certificates in incoming requests. This is not normally required as service providers will usually provide their CA certififcate to you separately.</p> <p>Default: no</p> <h5 id=ca_file>ca_file<a class=headerlink href=#ca_file title="Permanent link">&para;</a></h5> <p>Path to a file containing one or more CA certs in PEM format. These certs are used to verify the chain of trust for the certificate retrieved from the X5U Identity header parameter. This file must have the root CA certificate, the certificate of the issuer of the X5U certificate, and any intermediate certificates between them.</p> <p>Default: none See Also: <a href=#certificate-and-crl-notes>Certificate and CRL Notes</a> below</p> <h5 id=ca_path>ca_path<a class=headerlink href=#ca_path title="Permanent link">&para;</a></h5> <p>Path to a directory containing one or more hashed CA certs. See ca_file above. For this option, each certificate must be placed in its own PEM file in the directory specified and hashed with the following command: <code>openssl rehash &lt;ca_path&gt;</code></p> <p>Default: none<br> See Also: <a href=#certificate-and-crl-notes>Certificate and CRL Notes</a> below</p> <p>NOTE: Both ca_file and ca_path can be specified but at least one MUST be.</p> <h5 id=crl_file>crl_file<a class=headerlink href=#crl_file title="Permanent link">&para;</a></h5> <p>Path to a file containing one or more CRLs in PEM format. If you with to check if the certificate in the X5U Identity header parameter has been revoked, you'll need the certificate revocation list generated by the issuer. NOTE: CRLs are sometimes distributed in DER format instead of PEM format. You can covert a DER file to PEM with the folowing command:<br> <code>openssl crl -inform DER -in crl.der -outform PEM -out crl.pem</code></p> <p>Default: none<br> See Also: <a href=#certificate-and-crl-notes>Certificate and CRL Notes</a> below</p> <h5 id=crl_path>crl_path<a class=headerlink href=#crl_path title="Permanent link">&para;</a></h5> <p>Path to a directory containing one or more hashed CRLs. See crl_file above. For this option, each CRL must be placed in its own PEM file in the directory specified and hashed with the following command:<br> <code>openssl rehash &lt;crl_path&gt;</code></p> <p>Default: none<br> See Also: <a href=#certificate-and-crl-notes>Certificate and CRL Notes</a> below</p> <p>NOTE: Neither crl_file nor crl_path are required.</p> <h5 id=untrusted_cert_file>untrusted_cert_file<a class=headerlink href=#untrusted_cert_file title="Permanent link">&para;</a></h5> <p>Path to a file containing one or more untrusted certs in PEM format. Unfortunately, sometimes the CRLs are signed by a different CA than the certificate being verified. In this case, you'll need to provide the certificate belonging to the issuer of the CRL. That certificate is considered "untrusted" by OpenSSL and can't be placed in the ca_file or ca_path. It has to be specified here.</p> <p>Default: none<br> See Also: <a href=#certificate-and-crl-notes>Certificate and CRL Notes</a> below.<br> Added in Asterisk releases 18.25.0, 20.10.0, 21.5.0, certified-20.7-cert2</p> <h5 id=untrusted_cert_path>untrusted_cert_path<a class=headerlink href=#untrusted_cert_path title="Permanent link">&para;</a></h5> <p>Path to a directory containing one or more hashed untrusted certs used to verify CRLs. See untrusted_cert_file above. For this option, each certificates must be placed in its own PEM file in the directory specified and hashed with the following command:<br> <code>openssl rehash &lt;ca_path&gt;</code></p> <p>Default: none<br> See Also: <a href=#certificate-and-crl-notes>Certificate and CRL Notes</a> below.<br> Added in Asterisk releases 18.25.0, 20.10.0, 21.5.0, certified-20.7-cert2</p> <p>NOTE: Neither untrusted_cert_file nor untrusted_cert_path are required unless you're verifying CRLs that aren't signed by the same CA as the X5U certificate.</p> <h5 id=cert_cache_dir>cert_cache_dir<a class=headerlink href=#cert_cache_dir title="Permanent link">&para;</a></h5> <p>Incoming Identity headers will have a URL pointing to the certificate used to sign the header. To prevent us from having to retrieve the certificate for every request, we maintain a cache of them in the 'cert_cache_dir' specified. The directory will be checked for existence and writability at startup.</p> <p>Default: <astvarlibdir>/keys/stir_shaken/cache</p> <h5 id=curl_timeout>curl_timeout<a class=headerlink href=#curl_timeout title="Permanent link">&para;</a></h5> <p>The number of seconds we'll wait for a response when trying to retrieve the certificate specified in the incoming Identity header's "x5u" parameter.</p> <p>Default: 2</p> <h5 id=max_cache_entry_age>max_cache_entry_age<a class=headerlink href=#max_cache_entry_age title="Permanent link">&para;</a></h5> <p>Maximum age in seconds a certificate in the cache can reach before re-retrieving it.</p> <p>Default: 86400 (24 hours per ATIS-1000074)</p> <p>NOTE: If, when retrieving the URL specified by the "x5u" parameter, we receive a recognized caching directive in the HTTP response AND that directive indicates caching for MORE than the value set here, we'll use that time for the max_cache_entry_age.</p> <h5 id=max_cache_size>max_cache_size<a class=headerlink href=#max_cache_size title="Permanent link">&para;</a></h5> <p>Maximum number of entries the cache can hold. Not presently implemented.</p> <h5 id=max_iat_age>max_iat_age<a class=headerlink href=#max_iat_age title="Permanent link">&para;</a></h5> <p>The "iat" parameter in the Identity header indicates the time the sender actually created their attestation. If that is older than the current time by the number of seconds set here, the request will be considered "failed".</p> <p>Default: 15</p> <h5 id=max_date_header_age>max_date_header_age<a class=headerlink href=#max_date_header_age title="Permanent link">&para;</a></h5> <p>The sender MUST also send a SIP Date header in their request. If we receive one that is older than the current time by the number of seconds set here, the request will be considered "failed".</p> <p>Default: 15</p> <h5 id=failure_action>failure_action<a class=headerlink href=#failure_action title="Permanent link">&para;</a></h5> <p>Indicates what will happen to requests that have failed verification. Must be one of:</p> <ul> <li> <p><strong>continue</strong>: Continue processing the request. You can use the STIR_SHAKEN dialplan function to determine whether the request passed or failed verification and take the action you deem appropriate.</p> </li> <li> <p><strong>reject_request</strong>*: Reject the request immediately using the SIP response codes defined by RFC8224.</p> </li> <li> <p><strong>continue_return_reason</strong>: Continue processing the request but, per RFC8224, send a SIP Reason header back to the originator in the next provisional response indicating the issue according to RFC8224. You can use the STIR_SHAKEN dialplan function to determine whether the request passed or failed verification and take the action you deem appropriate.</p> </li> </ul> <p>Default: <strong>continue</strong></p> <p>NOTE: If you select "continue" or "continue_return_reason", and, based on the results from the STIR_SHAKEN function, you determine you want to terminate the call, you can use the PJSIPHangup() dialplan application to reject the call using a STIR/SHAKEN-specific SIP response code.</p> <h5 id=use_rfc9410_responses>use_rfc9410_responses<a class=headerlink href=#use_rfc9410_responses title="Permanent link">&para;</a></h5> <p>If set, when sending Reason headers back to originators, the protocol header parameter will be set to "STIR" rather than "SIP". This is a new protocol defined in RFC9410 and may not be supported by all participants.</p> <p>Default: no</p> <h5 id=relax_x5u_port_scheme_restrictions>relax_x5u_port_scheme_restrictions<a class=headerlink href=#relax_x5u_port_scheme_restrictions title="Permanent link">&para;</a></h5> <p>If set, the port and scheme restrictions imposed by <a href=https://access.atis.org/higherlogic/ws/public/download/67436/ATIS-1000074.v003.pdf>ATIS-1000074</a> section 5.3.1 that require the scheme to be "https" and the port to be 443 or 8443 are relaxed. This will allow schemes like "http" and ports other than the two mentioned to appear in x5u URLs received in Identity headers.</p> <p>Default: no</p> <p>CAUTION: Setting this parameter could have serious security implications and should only be use for testing.</p> <h5 id=relax_x5u_path_restrictions>relax_x5u_path_restrictions<a class=headerlink href=#relax_x5u_path_restrictions title="Permanent link">&para;</a></h5> <p>If set, the path restrictions imposed by <a href=https://access.atis.org/higherlogic/ws/public/download/67436/ATIS-1000074.v003.pdf>ATIS-1000074</a> section 5.3.1 that require the x5u URL to be rejected if it contains a query string, path parameters, fragment identifier or user/password are relaxed.</p> <p>Default: no</p> <p>CAUTION: Setting this parameter could have serious security implications and should only be use for testing.</p> <h5 id=x5u_permitx5u_deny>x5u_permit/x5u_deny<a class=headerlink href=#x5u_permitx5u_deny title="Permanent link">&para;</a></h5> <p>When set, the IP address of the host in a received Identity header x5u URL is checked against the acl created by this list of permit/deny parameters. If the check fails, the x5u URL will be considered invalid and verification will fail. This can prevent an attacker from sending you a request pretending to be a known originator with a mailcious certificate URL. (Server-side request forgery (SSRF)). See acl.conf.sample to see examples of how to specify the permit/deny parameters.</p> <p>Default: Per <a href=https://access.atis.org/higherlogic/ws/public/download/67436/ATIS-1000074.v003.pdf>ATIS-1000074</a> Deny all "Special-Purpose" IP addresses described in <a href=https://datatracker.ietf.org/doc/html/rfc6890>RFC 6890</a>. This includes the loopback addresses 127.0.0.0/8, private use networks such as 10.0.0/8, 172.16.0.0/12 and 192.168.0.0/16, and the link local network 169.254.0.0/16 among others.</p> <p>CAUTION: Setting this parameter could have serious security implications and should only be use for testing.</p> <h5 id=x5u_acl>x5u_acl<a class=headerlink href=#x5u_acl title="Permanent link">&para;</a></h5> <p>Rather than providing individual permit/deny parameters, you can set the acllist parameter to an acl list predefined in acl.conf.</p> <p>Default: none</p> <p>CAUTION: Setting this parameter could have serious security implications and should only be use for testing.</p> <h5 id=example-verification-object>Example "verification" object:<a class=headerlink href=#example-verification-object title="Permanent link">&para;</a></h5> <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>[verification]
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>global_disable = yes
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>load_system_certs = no
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>ca_path = /var/lib/asterisk/keys/stir_shaken/verification_ca
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>cert_cache_dir = /var/lib/asterisk/keys/stir_shaken/verification_cache
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>failure_action = reject_request
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>curl_timeout=5
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>max_iat_age=60
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>max_date_header_age=60
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>max_cache_entry_age = 300
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>; For internal testing
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>x5u_deny=0.0.0.0/0.0.0.0
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>x5u_permit=127.0.0.0/8
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>x5u_permit=192.168.100.0/24
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>relax_x5u_port_scheme_restrictions = yes
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>relax_x5u_path_restrictions = yes
</span></code></pre></div> <h4 id=profile-object>Profile Object<a class=headerlink href=#profile-object title="Permanent link">&para;</a></h4> <p>A "profile" object can be associated to channel driver endpoint (currently only chan_pjsip) and can set verification and attestation parameters specific to endpoints using this profile. If you have multiple upstream providers, this is the place to set parameters specific to them.</p> <p>The "id" of this object is arbitrary and you'd specify it in the "stir_shaken_profile" parameter of the endpoint.</p> <p>Parameters:</p> <h5 id=type>type<a class=headerlink href=#type title="Permanent link">&para;</a></h5> <p>Must be set to "profile"</p> <p>Default: none</p> <h5 id=endpoint_behhavior>endpoint_behhavior<a class=headerlink href=#endpoint_behhavior title="Permanent link">&para;</a></h5> <p>Actions to be performed for endpoints referencing this profile. Must be one of:</p> <ul> <li><strong>off</strong>: Don't do any STIR/SHAKEN processing.</li> <li><strong>attest</strong>: Attest on outgoing calls.</li> <li><strong>verify</strong>: Verify incoming calls.</li> <li><strong>on</strong>: Attest outgoing calls and verify incoming calls.</li> </ul> <p>Default: <strong>off</strong></p> <p>All of the "<a href=#verification>verification</a>" parameters defined above can be set on a profile with the exception of 'global_disable'.</p> <p>All of the "<a href=#attestation>attestation</a>" parameters defined above can be set on a profile with the exception of 'global_disable'.</p> <p>When Asterisk loads the configs, it creates "effective profiles" or "eprofiles" on the fly that are the amalgamation of the attestation, verification and profile. You can see them in the CLI with <code>stir_shaken show eprofiles</code>.</p> <h5 id=example-profile-object>Example "profile" object:<a class=headerlink href=#example-profile-object title="Permanent link">&para;</a></h5> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>[myprofile]
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>type = profile
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>endpoint_behavior = verify
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>failure_action = continue_return_reason
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>x5u_acl = myacllist
</span></code></pre></div> In pjsip.conf...</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>[myendpoint]
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>type = endpoint
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>...
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>stir_shaken_profile = myprofile
</span></code></pre></div> <p>In acl.conf...</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>[myacllist]
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>permit=0.0.0.0/0.0.0.0
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>deny=10.24.20.171
</span></code></pre></div> <h2 id=incoming-call-flow>Incoming Call Flow<a class=headerlink href=#incoming-call-flow title="Permanent link">&para;</a></h2> <p>We perform verification on incoming calls.</p> <ol type=1> <li>If there's no caller-id present, skip verification and continue the call.</li> <li>If the endpoint receiving the call doesn't have <code>stir_shaken_profile</code> set, skip verification and continue the call.</li> <li>If the profile name set in <code>stir_shaken_profile</code> doesn't exist, return an error and terminate the call.</li> <li>If the <a href=#verification>verification</a> <code>global_disable</code> flag is true, skip verification and continue the call.</li> <li>If the <a href=#profile-object>profile</a> <code>endpoint_behavior</code> parameter isn't <code>verify</code> or <code>on</code>, skip verification and continue the call.</li> </ol> <p>From now on, the action taken on failure is controlled by the <code>failure_action</code> parameter in the <a href=#profile-object>profile</a> or <a href=#verification-object>verification</a> objects. </p> <ol type=1> <li>If there's no Identity header in the SIP request, fail per <code>failure_action</code></li> <li>Parse the Identity header.</li> <li>Check the URL in the "x5u" header parameter against the rules described in <a href=#verification>Verification</a>.</li> <li>Check the "iat" header is within <code>max_iat_age</code> from the <a href=#profile-object>profile</a> or <a href=#verification>verification</a>.</li> <li>Check the SIP "Date" header is within the <code>max_date_header_age</code> from the <a href=#profile-object>profile</a> or [verification](#verif</li> <li>Check the local cache to see if we have the certificate already and it's cache expiration isn't in the past. If we have a good one, skip to the next step. Otherwise...<ul> <li>Retrieve the certificate from the URL.</li> <li>Parse the certificate and public key.</li> <li>Validate the certificate using the CA certificates and certificate revocation lists provided by the <code>ca_file</code>, <code>ca_path</code>, <code>crl_file</code> and <code>crl_path</code> parameters provided in the <a href=#profile-object>profile</a> or <a href=#verification-object>verification</a> objects and against the other rules mentioned in <a href=#verification>Verification</a>.</li> </ul> </li> <li>Decode the Identity header using the public key from the certificate. ication).</li> <li>Retrieve the rest of the parameters from the decoded Identity header.</li> <li>Verify that the caller id presented in the SIP message matches the "tn" parameter in the Identity header.</li> </ol> <p>If there was any failure and the <code>failure_action</code> parameter was set to <code>reject_request</code>, the request will be terminated with one of the 4XX response codes defined by <a href=https://www.rfc-editor.org/rfc/rfc8224>RFC-8224</a>.</p> <p>If <code>failure_action</code> was set to <code>continue_return_reason</code>, the call will be sent to the dialplan as usual but the next progress response to the client will contain a "Reason" header containing the 4XX response code that would have been sent if we were going to fail the call.</p> <p>If <code>failure_action</code> was set to <code>continue</code>, the call continues to the dialplan without any further action.</p> <p>If the call does continue under the last two conditions, the dialplan author can use the STIR_SHAKEN function to determine the verification status. They can then elect to continue or use the PJSIPHangup() dialplan app to terminate the call with a specific 4XX response code.</p> <h2 id=outgoing-call-flow>Outgoing Call Flow<a class=headerlink href=#outgoing-call-flow title="Permanent link">&para;</a></h2> <p>Compared to verification, attestation is simple.</p> <ol type=1> <li>If there's no caller-id present, skip attestation and continue the call.</li> <li>If the endpoint sending the call doesn't have <code>stir_shaken_profile</code> set, skip attestation and continue the call.</li> <li>If the profile name set in <code>stir_shaken_profile</code> doesn't exist, skip attestation and continue the call.</li> <li>If the <a href=#attestation>attestation</a> <code>global_disable</code> flag is true, skip attestation and continue the call.</li> <li>If the <a href=#profile-object>profile</a> <code>endpoint_behavior</code> parameter isn't <code>attest</code> or <code>on</code>, skip attestation and continue the call.</li> <li>If there's no "tn" object matching the caller-id, skip attestation and continue the call. With the 18.23.0, 20.8.0 and 21.3.0 releases of Asterisk, the caller-id is canonicalized (everything except 0-9, # and * are removed) before a "tn" object is searched for. Previously, the caller-id had to match the "tn" id exactly so a caller-id of "+1234567890" would NOT match a "tn" id of "1234567890".</li> <li>Finally create and sign the Identity header using the <code>private_key_file</code>, <code>public_cert_url</code>, <code>attest_level</code> and <code>send_mky</code> parameters from <a href=#tn-object>tn</a>, <a href=#profile-object>profile</a> or <a href=#attestation-object>attestation</a>. If this fails, the call will be terminated.</li> </ol> <h2 id=certificate-and-crl-notes>Certificate and CRL Notes<a class=headerlink href=#certificate-and-crl-notes title="Permanent link">&para;</a></h2> <p>Verifying the certificate retrieved by following the link in the received X5U Identity header parameter can be a tricky business. At a mimimum, you'll need the certificate of the X5U certificate's issuer. If the X5U certificate was signed by an intermediate certificate authority, you'll need that certificate plus any others up the chain to the issuer's root certificate authority. If you plan on verifying whether the X5U certificate has been revoked or not, you'll need the issuer's certificate revokation list and if the CRL was not signed by the same CA chain as the X5U certificate, you'll need the chain for the CRL as well.</p> <p>If the X5U certificate was produced by an entity that knows how to properly set up and operate a PKI infrastructure, there are some easy steps you can take to find those certificates yourself. If not, you are unfortunately at their mercy to provide you with the proper files. anyway...</p> <p>A properly constructed X5U certificate will have two X509 extensions that can help you get the issuer's certificate and, optionally, a CRL. If you have the URI in the X5U Identity header parameter, you can use <code>curl</code> to retrieve it manually...</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>curl -o somecompany-x5u.pem https://somecompany.com/somecert.pem
</span></code></pre></div> <p>You can now dump the contents of the certificate with <code>openssl</code>...</p> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>openssl x509 -in somecompany-x5u.pem -noout -text
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>Certificate:
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>    &lt;snipped&gt;
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>    Issuer: CN=STO CA1 - SHAKEN Intermediate, O=Some Telecom Operator, OU=Certificate Authority, C=US
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a>    &lt;snipped&gt;
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    X509v3 extensions:
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>      Authority Information Access: 
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>        CA Issuers - URI:https://somecomnany.com/ca/certs/intermediate-ca.cer
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>      X509v3 CRL Distribution Points: 
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>        Full Name:
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>          URI:https://somecompany.com/crl                CRL Issuer:
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>          DirName:CN = STO PA1, O = Some Telecom Operator, OU = Policy Authority, C = US
</span></code></pre></div> You'll notice a few things... * The issuer is an intermediate certificate authority. * The <code>Authority Information Access</code> extension has a URI to the intermediate CA's certificate. * There's a <code>CRL Distribution Points</code> extension with a URI to the CRL. This may or may not be present. * The CRL issuer isn't the same as this certificate's issuer. This is known as an "Indirect CRL". It's rare but it can happen.</p> <p>So, now it's a matter of following those URIs, dumping the objects, and repeating until you reach the top.</p> <p><div class="language-text highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>curl -o intermediate1-ca.pem https://somecomnany.com/ca/certs/intermediate1-ca.cer
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>openssl x509 -in intermediate1-ca.pem -noout -text
</span></code></pre></div> Look for intermediate-ca.cer's <code>Authority Information Access</code> extension, download it, dump it, and repeat until you find the root CA certificate. You'll know it because its Issuer and Subject will be the same and there won't be a <code>Authority Information Access</code> extension. All of these certificates will need to be supplied in either <a href=#ca_file>verification - ca_file</a> or <a href=#ca_path>verification - ca_path</a>.</p> <p>If there was a CRL specified and you wish to check whether the X5U certificate was revoked or not, download and dump the CRL.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>curl -o somecompany.crl https://somecompany.com/crl
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>openssl crl -in somecompany.crl -noout -text
</span></code></pre></div> <p>The CRL should also have an <code>Authority Information Access</code> extension that has the URI to the CRL issuer's certificate. If it's not the same as any of the certificates already retrieved by the above process, perform the same download and dump process as above until you get to the root CA certificate. Any of these certificates that weren't already retrieved above will need to be supplied in either <a href=#untrusted_cert_file>verification - untrusted_cert_file</a> or <a href=#untrusted_cert_path>verification - untrusted_cert_path</a>.</p> <p>The CRL itself will need to be supplied in either <a href=#crl_file>verification - crl_file</a> or <a href=#crl_path>verification - crl_path</a>. Be aware though, some CRLs are distributed in DER format instead of PEM format. You can check which format was retrieved by running <code>file &lt;crl_file&gt;</code>. If the result is <code>ASCII text</code>, it's already PEM format. If the result is <code>data</code>, it's DER format. Since asterisk can only accept PEM format files, you'll need to convert the DER CRL into PEM format with the following command:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>openssl crl -inform DER -in somecompany.crl -outform PEM -out somecompany-crl.pem
</span></code></pre></div> <p>You can test that you have all the files needed for a successful verification by performing the following...</p> <p>Concatenate all the CA certificates downloaded into a single file.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>cat intermediate1-ca.pem intermediate2-ca.pem root-ca.pem &gt; somecompany-fullchain.pem
</span></code></pre></div> <p>Concatenate all the untrusted certificates downloaded into a single file. Don't include any CA certificates already downloaded previously.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>cat untrusted1-ca.pem untrusted2-ca.pem untrusted-ca.pem &gt; somecompany-untrusted.pem
</span></code></pre></div> <p>Run the <code>openssl verify</code> command.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>openssl verify -CAfile somecompany-fullchain.pem -CRLfile somecompany-crl.pem \
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>  -untrusted somecompany-untrusted.pem -crl_check -extended_crl somecert-x5u.pem
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>somecert-x5u.pem: OK
</span></code></pre></div> <p>If you're not checking against a CRL, you can leave those bits out...</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a>openssl verify -CAfile somecompany-fullchain.pem somecert-x5u.pem
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>somecert-x5u.pem: OK
</span></code></pre></div> <p>You can use the same somecompany-fullchain.pem, somecompany-crl.pem, and somecompany-untrusted.pem file as the values for the <a href=#ca_file>verification - ca_file</a>, <a href=#crl_file>verification - crl_file</a> and <a href=#untrusted_cert_file>verification - untrusted_cert_file</a> stir_shaken.conf values.</p> <p>Starting in Asterisk versions, 18.25.0, 20.10.0, 21.5.0 and certified-20.7-cert2, a new CLI command <code>stir_shaken verify certificate_file</code> is available. If you've properly configured the ca, crl and untrusted_cert parameters in stir_shaken.conf, you can check if Asterisk can verify a certificate with the following command:<br> <code>CLI&gt; stir_shaken verify certificate_file &lt;path_to_cert_file&gt;</code>.<br> You'll get the same results you'd get with the <code>openssl verify</code> command.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <p>The best places to become familiar with STIR/SHAKEN itself are:</p> <ul> <li><a href=https://www.rfc-editor.org/rfc/rfc7340.html>RFC7340 Secure Telephone Identity Problem Statement and Requirements</a></li> <li><a href=https://www.rfc-editor.org/rfc/rfc7375.html>RFC7375 Secure Telephone Identity Threat Model</a></li> <li><a href=https://www.rfc-editor.org/rfc/rfc8224.html>RFC8224 Authenticated Identity Management in the Session Initiation Protocol (SIP)</a></li> <li><a href=https://www.rfc-editor.org/rfc/rfc9060.html>RFC 9060 Secure Telephone Identity Revisited (STIR) Certificate Delegation</a></li> <li><a href=https://access.atis.org/higherlogic/ws/public/download/67436/ATIS-1000074.v003.pdf>ATIS-1000074v003: Signature-based Handling of Asserted information using toKENs (SHAKEN)</a></li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Content is licensed under a Creative Commons Attribution-ShareAlike 3.0 United States License. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.asterisk.org/ target=_blank rel=noopener title=www.asterisk.org class=md-social__link> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg version=1.1 id=svg2 width=48 height=48 viewbox="0 0 48 48" sodipodi:docname=favicon.svg inkscape:version="1.2.2 (b0a8486541, 2022-12-01)" xmlns:inkscape=http://www.inkscape.org/namespaces/inkscape xmlns:sodipodi=http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd xmlns:xlink=http://www.w3.org/1999/xlink xmlns=http://www.w3.org/2000/svg xmlns:svg=http://www.w3.org/2000/svg> <defs id=defs6 /> <sodipodi:namedview id=namedview4 pagecolor=#ffffff bordercolor=#666666 borderopacity=1.0 inkscape:showpageshadow=2 inkscape:pageopacity=0.0 inkscape:pagecheckerboard=0 inkscape:deskcolor=#d1d1d1 showgrid=false inkscape:zoom=17.291667 inkscape:cx=24 inkscape:cy=24.028916 inkscape:current-layer=g8 /> <g inkscape:groupmode=layer inkscape:label=Image id=g8> <image width=48 height=48 preserveaspectratio=none id=image10 xlink:href="data:image/png;base64,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
"/> </g> </svg> </a> <a href=https://www.asterisk.org/blog/ target=_blank rel=noopener title=www.asterisk.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="m61.7 169.4 101.5 278C92.2 413 43.3 340.2 43.3 256c0-30.9 6.6-60.1 18.4-86.6m337.9 75.9c0-26.3-9.4-44.5-17.5-58.7-10.8-17.5-20.9-32.4-20.9-49.9 0-19.6 14.8-37.8 35.7-37.8.9 0 1.8.1 2.8.2-37.9-34.7-88.3-55.9-143.7-55.9-74.3 0-139.7 38.1-177.8 95.9 5 .2 9.7.3 13.7.3 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l77.5 230.4L249.8 247l-33.1-90.8c-11.5-.7-22.3-2-22.3-2-11.5-.7-10.1-18.2 1.3-17.5 0 0 35.1 2.7 56 2.7 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l76.9 228.7 21.2-70.9c9-29.4 16-50.5 16-68.7m-139.9 29.3-63.8 185.5c19.1 5.6 39.2 8.7 60.1 8.7 24.8 0 48.5-4.3 70.6-12.1-.6-.9-1.1-1.9-1.5-2.9zm183-120.7c.9 6.8 1.4 14 1.4 21.9 0 21.6-4 45.8-16.2 76.2l-65 187.9C426.2 403 468.7 334.5 468.7 256c0-37-9.4-71.8-26-102.1M8 256a248 248 0 1 1 496 0 248 248 0 1 1-496 0m484.6 0a236.6 236.6 0 1 0-473.2 0 236.6 236.6 0 1 0 473.2 0"/></svg> </a> <a href=https://twitter.com/asteriskdev target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> <a href=https://github.com/asterisk target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://community.asterisk.org target=_blank rel=noopener title=community.asterisk.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.prune", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "toc.follow"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.92b07e13.min.js></script> </body> </html>