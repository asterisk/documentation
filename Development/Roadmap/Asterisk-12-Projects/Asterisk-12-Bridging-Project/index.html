<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://docs.asterisk.org/Development/Roadmap/Asterisk-12-Projects/Asterisk-12-Bridging-Project/ rel=canonical><link href=../Asterisk-12-API-Improvements/Stasis-Message-Bus/Using-the-Stasis-Message-Bus/Stasis-Subscriber-Shutdown-Problem/ rel=prev><link href=Asterisk-12-Bridging-API/ rel=next><link rel=icon href=../../../../favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.19"><title>Overview - Asterisk Documentation</title><link rel=stylesheet href=../../../../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../material-override.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2ZKMCW9DZ9"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2ZKMCW9DZ9",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2ZKMCW9DZ9",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#project-overview class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="Asterisk Documentation" class="md-header__button md-logo" aria-label="Asterisk Documentation" data-md-component=logo> <img src=../../../../favicon.ico alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Asterisk Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Overview </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <table border=0 style="width: max-content;padding:0px;margin:0px"><tr><td> <a href=https://github.com/asterisk/asterisk title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Asterisk </div> </a> </td> <td style=font-size:.65rem;line-height:1.2;vertical-align:middle;> <a href=/About-the-Project/Asterisk-Versions>Asterisk Versions</a><br> <a target=_blank href=https://github.com/asterisk/documentation/issues>Report Documentation Issues</a><br> <a target=_blank href=https://github.com/asterisk/documentation>Contribute to the Documentation</a> </td></tr> </table> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="Asterisk Documentation" class="md-nav__button md-logo" aria-label="Asterisk Documentation" data-md-component=logo> <img src=../../../../favicon.ico alt=logo> </a> Asterisk Documentation </label> <div class=md-nav__source> <table border=0 style="width: max-content;padding:0px;margin:0px"><tr><td> <a href=https://github.com/asterisk/asterisk title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> Asterisk </div> </a> </td> <td style=font-size:.65rem;line-height:1.2;vertical-align:middle;> <a href=/About-the-Project/Asterisk-Versions>Asterisk Versions</a><br> <a target=_blank href=https://github.com/asterisk/documentation/issues>Report Documentation Issues</a><br> <a target=_blank href=https://github.com/asterisk/documentation>Contribute to the Documentation</a> </td></tr> </table> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../About-the-Project/ class=md-nav__link> <span class=md-ellipsis> About the Project </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk-Community/ class=md-nav__link> <span class=md-ellipsis> Asterisk Community </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Fundamentals/ class=md-nav__link> <span class=md-ellipsis> Fundamentals </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Getting-Started/Beginning-Asterisk/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Configuration/Core-Configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Deployment/ class=md-nav__link> <span class=md-ellipsis> Deployment </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Operation/ class=md-nav__link> <span class=md-ellipsis> Operation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8 checked> <div class="md-nav__link md-nav__container"> <a href=../../../ class="md-nav__link "> <span class=md-ellipsis> Development </span> </a> <label class="md-nav__link " for=__nav_8 id=__nav_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=true> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../Policies-and-Procedures/ class=md-nav__link> <span class=md-ellipsis> Policies and Procedures </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../Debugging/ class=md-nav__link> <span class=md-ellipsis> Debugging </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../Reference-Information/ class=md-nav__link> <span class=md-ellipsis> Reference Information </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_5 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> Roadmap </span> </a> <label class="md-nav__link " for=__nav_8_5 id=__nav_8_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_8_5_label aria-expanded=true> <label class=md-nav__title for=__nav_8_5> <span class="md-nav__icon md-icon"></span> Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../AstriCon-2012-Presentations/ class=md-nav__link> <span class=md-ellipsis> AstriCon 2012 Presentations </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2010/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2010 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2011/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2011 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2012/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2012 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2013/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2013 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2014/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2014 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2015/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2015 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2016/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2016 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2017/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2017 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2022/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2022 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2024-December/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2024 December </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2024/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2024 </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2025-April/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2025 April </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon-2025-July/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2025 July </span> </a> </li> <li class=md-nav__item> <a href=../../AstriDevCon/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon </span> </a> </li> <li class=md-nav__item> <a href=../../Astricon-2021-Presentation-attachments/ class=md-nav__link> <span class=md-ellipsis> Astricon 2021 Presentation attachments </span> </a> </li> <li class=md-nav__item> <a href=../../FOSDEM-2011-Open-Source-Telephony-Devroom/ class=md-nav__link> <span class=md-ellipsis> FOSDEM 2011 Open Source Telephony Devroom </span> </a> </li> <li class=md-nav__item> <a href=../../OpenSIPit-2021/ class=md-nav__link> <span class=md-ellipsis> OpenSIPit 2021 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-10-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 10 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-11-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 11 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_5_22 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Asterisk 12 Projects </span> </a> <label class="md-nav__link " for=__nav_8_5_22 id=__nav_8_5_22_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_8_5_22_label aria-expanded=true> <label class=md-nav__title for=__nav_8_5_22> <span class="md-nav__icon md-icon"></span> Asterisk 12 Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Data-Access-Layer-Design/ class=md-nav__link> <span class=md-ellipsis> Data Access Layer Design </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../Asterisk-12-API-Improvements/ class=md-nav__link> <span class=md-ellipsis> Asterisk 12 API Improvements </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8_5_22_4 checked> <div class="md-nav__link md-nav__container"> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Asterisk 12 Bridging Project </span> </a> <label class="md-nav__link md-nav__link--active" for=__nav_8_5_22_4 id=__nav_8_5_22_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_8_5_22_4_label aria-expanded=true> <label class=md-nav__title for=__nav_8_5_22_4> <span class="md-nav__icon md-icon"></span> Asterisk 12 Bridging Project </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=Asterisk-12-Bridging-API/ class=md-nav__link> <span class=md-ellipsis> Asterisk 12 Bridging API </span> </a> </li> <li class=md-nav__item> <a href=Asterisk-12-Bridging-Test-Plan/ class=md-nav__link> <span class=md-ellipsis> Asterisk 12 Bridging Test Plan </span> </a> </li> <li class=md-nav__item> <a href=Asterisk-12-Bridging-Use-Cases/ class=md-nav__link> <span class=md-ellipsis> Asterisk 12 Bridging Use Cases </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../New-SIP-channel-driver/ class=md-nav__link> <span class=md-ellipsis> New SIP channel driver </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-13-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 13 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-14-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 14 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-15-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 15 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-16-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 16 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-18-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 18 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Asterisk-19-Projects/ class=md-nav__link> <span class=md-ellipsis> Asterisk 19 Projects </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../AstriDevCon-2018/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2018 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../AstriDevCon-2019/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2019 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../AstriDevCon-2020/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2020 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../AstriDevCon-2021/ class=md-nav__link> <span class=md-ellipsis> AstriDevCon 2021 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Future-Potential-Project-Thoughts/ class=md-nav__link> <span class=md-ellipsis> Future Potential Project Thoughts </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../../Asterisk-Bug-Bounties/ class=md-nav__link> <span class=md-ellipsis> Asterisk Bug Bounties </span> </a> </li> <li class=md-nav__item> <a href=../../../Asterisk-C-API-Deprecations/ class=md-nav__link> <span class=md-ellipsis> Asterisk C API Deprecations </span> </a> </li> <li class=md-nav__item> <a href=../../../Asterisk-Module-Deprecations/ class=md-nav__link> <span class=md-ellipsis> Asterisk Module Deprecations </span> </a> </li> <li class=md-nav__item> <a href=../../../Asterisk-Open-Source-Maintainers/ class=md-nav__link> <span class=md-ellipsis> Asterisk Open Source Maintainers </span> </a> </li> <li class=md-nav__item> <a href=../../../Open-Features-and-Improvements/ class=md-nav__link> <span class=md-ellipsis> Open Features and Improvements </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Latest_API/ class=md-nav__link> <span class=md-ellipsis> Latest API </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk_16_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 16 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk_18_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 18 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk_19_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 19 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk_20_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 20 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk_21_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 21 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk_22_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 22 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Asterisk_23_Documentation/ class=md-nav__link> <span class=md-ellipsis> Asterisk 23 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Certified-Asterisk_18.9_Documentation/ class=md-nav__link> <span class=md-ellipsis> Certified Asterisk 18.9 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Certified-Asterisk_20.7_Documentation/ class=md-nav__link> <span class=md-ellipsis> Certified Asterisk 20.7 Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Test-Suite-Documentation/ class=md-nav__link> <span class=md-ellipsis> Test Suite Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../Historical-Documentation/ class=md-nav__link> <span class=md-ellipsis> Historical Documentation </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../../Contributing-to-the-Documentation/ class=md-nav__link> <span class=md-ellipsis> Contributing to the Documentation </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#what-is-a-masquerade class=md-nav__link> <span class=md-ellipsis> What is a Masquerade </span> </a> </li> <li class=md-nav__item> <a href=#why-bridging-uses-masquerades-and-what-we-can-do-about-it class=md-nav__link> <span class=md-ellipsis> Why Bridging Uses Masquerades and what We can do about it </span> </a> </li> <li class=md-nav__item> <a href=#the-future-of-masquerades-is-grim class=md-nav__link> <span class=md-ellipsis> The Future of Masquerades is Grim </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This page is a living document; expect missing and incomplete information. Still, feel free to discuss on <a href=http://lists.digium.com/mailman/listinfo/asterisk-dev>asterisk-dev</a>.</p> </div> <h1 id=project-overview>Project Overview<a class=headerlink href=#project-overview title="Permanent link">&para;</a></h1> <p>At <a href=/Development/Roadmap/AstriDevCon-2012>AstriDevCon 2012</a>, one of the focus points of development was determined to be the <a href=../Asterisk-12-API-Improvements>Asterisk APIs</a>. In particular, some common complaints were:</p> <ul> <li>Asterisk changes the name of a channel during masquerades. As the name is used as the handle to the channel, this requires a lot of state replication by consumers of the APIs.</li> <li>Asterisk's APIs tend to expose internal implementation details (such as masquerades), when consumers of the APIs would rather not be aware of these details.</li> </ul> <p>Both of these topics often come back to the same problem: masquerades. But why are masquerades such a problem?</p> <h2 id=what-is-a-masquerade>What is a Masquerade<a class=headerlink href=#what-is-a-masquerade title="Permanent link">&para;</a></h2> <p>A channel masquerade is a fundamental yet incredibly confusing concept in Asterisk. It exists as a way for a thread to 'take' control of a channel that happens to be on another thread. This is a critically important operation when you need to, say, move a channel from the VoiceMail application and have it start executing logic at a different place in the dialplan.</p> <hr> <p>A comment from ast_do_masquerade </p> <div class="language-text highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>/* XXX This operation is a bit odd. We&#39;re essentially putting the guts of
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a> * the clone channel into the original channel. Start by killing off the
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a> * original channel&#39;s backend. While the features are nice, which is the
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a> * reason we&#39;re keeping it, it&#39;s still awesomely weird. XX */
</span></code></pre></div> <p>The way the operation works is to take two channels and 'swap' portions of them. In the diagram below, assume that Thread A has a channel that Thread B wants to take over. Thread B creates a new channel ("Original") and starts a Masquerade operation on the channel owned by Thread A ("Clone"). Both channels are locked, and the state of the Clone channel is moved into the Original channel, while the Clone channel obtains the Original channel's state. In order to denote that the channel is about to die, a special ZOMBIE flag is put on the channel and the name renamed to Clone<zombie>. The lock is released, and the Original channel - which now has the state associated with Clone channel - executes in Thread B, while the Clone channel (which is now quite dead) see's that its dead and goes off to silently contemplate its demise in an <code>h</code> extension.</p> <p>Asterisk_12_MasqueradesL Except, of course, that this is a dramatic simplification. It's never quite that easy.</p> <ul> <li>What is a channel's state? For the purposes of the operation, we consider it to be the channel's datastores, technology, and other pertinent data - but there's plenty of data that shouldn't be transferred over. That includes things like locking primitives on the channel, file descriptors, and other resources that Thread A is probably using (and depending on). Other information - such as CDR related information - sometimes can be moved, and sometimes shouldn't.</li> <li>The locking picture is complicated. Thread B has no idea what Thread A is doing with the channel when it tries to get the channel lock for the Clone channel. If Thread B is holding a lock and tries to get Clone's channel lock, and Thread A is holding Clone's channel lock and needs a lock held by Thread B, a deadlock occurs.</li> <li>Lots of things care a lot when the name of a channel is swapped out from underneath the actual channel pointer. Channel technologies care a lot, and so there are masquerade callbacks that go into the channel technologies and notify them when a masquerade occurs. This creates another locking point, complicating the locking picture further (and causing more deadlocks).</li> </ul> <p>So, Masquerades are bad. But why are they used everywhere?</p> <h2 id=why-bridging-uses-masquerades-and-what-we-can-do-about-it>Why Bridging Uses Masquerades and what We can do about it<a class=headerlink href=#why-bridging-uses-masquerades-and-what-we-can-do-about-it title="Permanent link">&para;</a></h2> <div class="admonition tip channel farm"> <p class=admonition-title>Tip</p> <p>"All channels are created equal, but some channels are created more equal than others."</p> </div> <p>Not all channels get an execution thread (<code>pbx_thread</code>) in Asterisk. In general, an inbound channel get's a thread; outbound channels do not. As a result, a two-party bridge that is created between the two channels uses the inbound channel's <code>pbx_thread</code> to service frames between the two channels. Regardless of the two-party bridge type in play, this is how it works in Asterisk.</p> <p>This made sense when most bridges were two-party bridges. They probably still are, but it's very common now to have scenarios that require a lot more than a two-party bridge. Say, for example, we want to blind transfer the outbound channel to a new dialplan extension. The outbound channel has no <code>pbx_thread</code> - so how can we get him there?</p> <p>Simple! We use a Masquerade. The Masquerade creates a new channel (with a <code>pbx_thread</code>) and swaps the guts of the outbound channel with the new channel. The new channel (with the guts of the outbound channel) starts to execute, and the old outbound channel dies.</p> <p>You can see what happened next: everything started to use Masquerades to get around the fact that there were channels without threads. Transfers, Asynchronous Gotos, Parking, Local channel optimization... lots of things ended up needing to use Masquerades to work around the threading model.</p> <p>Then, along came <a href=/Configuration/Applications/Conferencing-Applications/ConfBridge>ConfBridge</a>.</p> <div class="admonition note we all do"> <p class=admonition-title>Note</p> <p>Ignore MeetMe.</p> </div> <p>ConfBridge used a brand spiffy "new" (as in Asterisk 1.6 timeframe) Bridging API developed by Joshua Colp. A bridge becomes a first class object, and no longer a state that two channels happen to find themselves in. Channels owned by a bridge object are each given a thread. Even more interesting, the Bridging API provided an abstraction above how the media of the channels in the bridge was mixed. ConfBridge, for example, used the softmix bridging technology, suitable for multiple channels in a bridge. However, there are other bridging technologies - some optimized for managing two channels (or sets of two channels). Others - such as bridging technologies developed for special purpose applications - are possible. The Bridging API itself provides safe mechanisms to move channels between bridges, merge bridges, and generally do things without the need for masquerades.</p> <p>As a side effect, the view from the outside world of what Asterisk is doing to channels in a bridge becomes sane.</p> <h2 id=the-future-of-masquerades-is-grim>The Future of Masquerades is Grim<a class=headerlink href=#the-future-of-masquerades-is-grim title="Permanent link">&para;</a></h2> <p>Unfortunately, there is still one reason to use a Masquerade: when you have to steal it out of an application. This occurs in situations where an attended transfer is performed and the party starting the attended transfer does not transfer the other party into a bridge but rather into an application. So they aren't going to go away completely.</p> <p>But, a wholesale migration to the Bridging API let's us:</p> <ul> <li>Do away with Masquerades in lots of situations</li> <li>Optimize the hell out of two party bridging</li> <li>Switch between two and multi-party bridging seamlessly</li> <li>Present a sane model of the bridging world to the APIs</li> </ul> <div class="admonition tip a word of advice"> <p class=admonition-title>Tip</p> <p>If you're familiar with the bridging code in <code>features.c</code>, you probably have a good idea of how big a task this work is. When you do away with the bridging loop, lots of things break, and they aren't all obvious. CDRs break. CEL breaks. Queue Logs probably break. AMI is wonky. DTMF handling has to be tweaked significantly. Lots change.</p> <p>This is scary, but it's time.</p> </div> <h1 id=requirements-and-specification>Requirements and Specification<a class=headerlink href=#requirements-and-specification title="Permanent link">&para;</a></h1> <p>Functionally, Bridging should remain as much the same as possible when compared with previous versions. When this is not possible, the difference should be documented.</p> <p>The following will require specifications for Asterisk 12:</p> <ul> <li>CDRs</li> <li>CEL</li> <li>Queue Log</li> <li>AMI (see ﻿<a href=/Configuration/Interfaces/Asterisk-Manager-Interface-AMI/AMI-v2-Specification>AMI v2 Specification</a>)</li> </ul> <p>For Use Cases, see <a href=Asterisk-12-Bridging-Use-Cases>Bridging Use Cases</a>.</p> <h1 id=design>Design<a class=headerlink href=#design title="Permanent link">&para;</a></h1> <h2 id=high-level-design>High Level Design<a class=headerlink href=#high-level-design title="Permanent link">&para;</a></h2> <p>Note that the diagram below is not meant to contain all functions and attributes for the objects shown, nor does it show all objects. It is meant to convey the relationships between principle objects in the Bridging Framework.</p> <p>Bridge API DesignL</p> <h4 id=ast_bridge_controller>ast_bridge_controller<a class=headerlink href=#ast_bridge_controller title="Permanent link">&para;</a></h4> <p>The <code>ast_bridge_controller</code> manages one or more bridges. It provides the thread that services actions that are being taken within a bridge and operations between bridges.</p> <h4 id=ast_bridge>ast_bridge<a class=headerlink href=#ast_bridge title="Permanent link">&para;</a></h4> <p>An <code>ast_bridge</code> object <strong>is</strong> the bridge. A bridge may have many channels in it, and the bridge object is responsible for keeping track of the state of the bridge and managing the channels. The <code>ast_bridge_technology</code> callbacks provide the way in which operations on the bridge and its channels are implemented for different ways of 'bridging'. For example, in a two-party bridge, the bridge technology may only have to pass frames between two channels and can simply swap the frames between two <code>ast_bridge_channel</code> objects. In a multi-party bridge, however, the bridge technology has to decide which <code>ast_bridge_channel</code> objects receive frames from what other <code>ast_bridge_channel</code> objects, how those frames are mixed, etc.</p> <h4 id=ast_bridge_channel>ast_bridge_channel<a class=headerlink href=#ast_bridge_channel title="Permanent link">&para;</a></h4> <p>The <code>ast_bridge_channel</code> object manages the thread, state, and actions executing on a channel in a bridge. There is a one to one relationship between the <code>ast_bridge_channel</code> object and an <code>ast_channel</code> object in a bridge. An <code>ast_bridge</code> manages channels through the <code>ast_bridge_channel</code> object.</p> <h4 id=ast_bridge_technology>ast_bridge_technology<a class=headerlink href=#ast_bridge_technology title="Permanent link">&para;</a></h4> <p>The <code>ast_bridge_technology</code> provides the callbacks that specific bridging implementations implement. It is up to the bridging implementations to determine how frames are passed between the <code>ast_bridge_channel</code> objects, what Asterisk control frames are processed and how, etc.</p> <h4 id=ast_bridge_features>ast_bridge_features<a class=headerlink href=#ast_bridge_features title="Permanent link">&para;</a></h4> <p>The <code>ast_bridge_features</code> object provides hooks that can be passed to <code>ast_bridge_channel</code> objects when they join that bridge. The feature hooks implement specific interception callbacks that occur on DTMF key presses, after some period of time has passed, or given some other criteria. These callbacks can affect the channels in a bridge but may also affect the entire bridge.</p> <p>Detailed information about the Bridging Framework APIs can be seen in <a href=Asterisk-12-Bridging-API>Asterisk 12 Bridging API</a>.</p> <h2 id=richards-ramblings-on-bridging>Richard's Ramblings on Bridging<a class=headerlink href=#richards-ramblings-on-bridging title="Permanent link">&para;</a></h2> <h3 id=the-existing-api-and-proposed-changes>The Existing API and Proposed Changes<a class=headerlink href=#the-existing-api-and-proposed-changes title="Permanent link">&para;</a></h3> <h4 id=enum-ast_bridge_channel_state-ast_bridge_joinstruct-ast_bridge-bridge-struct-ast_channel-chan-struct-ast_channel-swap-struct-ast_bridge_features-features-struct-ast_bridge_tech_optimizations-tech_args-int-pass_reference>enum ast_bridge_channel_state ast_bridge_join(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_channel *swap, struct ast_bridge_features *features, struct, ast_bridge_tech_optimizations *tech_args, int pass_reference);<a class=headerlink href=#enum-ast_bridge_channel_state-ast_bridge_joinstruct-ast_bridge-bridge-struct-ast_channel-chan-struct-ast_channel-swap-struct-ast_bridge_features-features-struct-ast_bridge_tech_optimizations-tech_args-int-pass_reference title="Permanent link">&para;</a></h4> <ul> <li>Put a channel into the specified bridge. The bridge takes custody of the channel.<ul> <li>On success, the caller blocks until:<ul> <li>the channel hangs up</li> <li>the channel is kicked out</li> <li>the bridge dissolves<ul> <li>The caller must then run the PBX which runs the h exten, next dialplan location, or ast_async_goto() location.</li> </ul> </li> </ul> </li> </ul> </li> <li>An error joining the bridge gives the channel back.</li> <li>The pass_reference flag passes the bridge reference of the caller back to the bridge so the bridge will complete destroying itself when the last channel leaves the bridge. The caller cannot use the bridge pointer when the function returns.</li> </ul> <h4 id=int-ast_bridge_impartstruct-ast_bridge-bridge-struct-ast_channel-chan-struct-ast_channel-swap-struct-ast_bridge_features-features-int-independent>int ast_bridge_impart(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_channel *swap, struct ast_bridge_features *features, int independent);<a class=headerlink href=#int-ast_bridge_impartstruct-ast_bridge-bridge-struct-ast_channel-chan-struct-ast_channel-swap-struct-ast_bridge_features-features-int-independent title="Permanent link">&para;</a></h4> <ul> <li>Put a channel into the specified bridge. The bridge takes custody of the channel.</li> <li>The caller does not block.</li> <li>An error joining the bridge gives the channel back.</li> <li>On success, the caller does not get the channel back.</li> <li>When the channel leaves the bridge the channel will:<ul> <li>wait for another thread to claim it with ast_bridge_depart() if not specified as independent</li> <li>run a PBX at the set location if exited by AST_SOFTHANGUP_ASYNCGOTO (any exit location datastore is removed)</li> <li>run a PBX if a location is specified by datastore</li> <li>run the h exten if specifed by datastore then hangup</li> <li>hangup</li> </ul> </li> </ul> <h4 id=int-ast_bridge_departstruct-ast_channel-chan>int ast_bridge_depart(struct ast_channel *chan);<a class=headerlink href=#int-ast_bridge_departstruct-ast_channel-chan title="Permanent link">&para;</a></h4> <ul> <li>This function must be removed from the API or severely restricted.</li> </ul> <p>API changed that when a channel is imparted, it must be specified that the channel will be departed. These channels can not be moved/merged to another bridge. Channels that can be departed are special channels because the channel must be departed and can not be made to normally execute dialplan when they leave a bridge.</p> <p>With the change that ast_channel has an ast_bridge_channel pointer instead of an ast_bridge pointer, ast_bridge_depart() does not need to be provided an ast_bridge pointer. Also these channels can move to other bridges and still be departed.</p> <p>Departing from the bridge must not interfere with an AST_BRIDGE_CHANNEL_STATE_END in progress since it is likely to dissolve the bridge. (Sorta fixed with AST_BRIDGE_CHANNEL_STATE_DEPART_END. Really need to revamp the depart mess.)</p> <h4 id=int-ast_bridge_removestruct-ast_bridge-bridge-struct-ast_channel-chan>int ast_bridge_remove(struct ast_bridge *bridge, struct ast_channel *chan);<a class=headerlink href=#int-ast_bridge_removestruct-ast_bridge-bridge-struct-ast_channel-chan title="Permanent link">&para;</a></h4> <ul> <li>Request that the channel be removed from the specified bridge.</li> <li>If the channel is not in a bridge then return error.</li> </ul> <p>Channels are removed when the bridge action kicks the channel out. It does not matter if the channel is currently suspended from the bridge.</p> <h4 id=int-ast_bridge_movestruct-ast_bridge-bridge-struct-ast_channel-chan-struct-ast_channel-swap-struct-ast_bridge_features-features-struct-ast_bridge_tech_optimizations-tech_args>int ast_bridge_move(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_channel *swap, struct ast_bridge_features *features, struct ast_bridge_tech_optimizations *tech_args);<a class=headerlink href=#int-ast_bridge_movestruct-ast_bridge-bridge-struct-ast_channel-chan-struct-ast_channel-swap-struct-ast_bridge_features-features-struct-ast_bridge_tech_optimizations-tech_args title="Permanent link">&para;</a></h4> <ul> <li>Move a channel from its current bridge to the specified bridge.</li> <li>The channel knows which bridge it is in because ast_channel_internal_bridge() returns it.</li> <li>If the channel is not in a bridge then return error.</li> <li>If the channel is not moveable then return error.</li> <li>If the channel is already in the bridge then return error.</li> <li>If the bridge cannot accept the channel then return error.</li> </ul> <h4 id=int-ast_bridge_mergestruct-ast_bridge-bridge_dest-struct-ast_bridge-bridge_src-struct-ast_channel-exclude_chans-int-num_chans>int ast_bridge_merge(struct ast_bridge *bridge_dest, struct ast_bridge *bridge_src, struct ast_channel **exclude_chans, int num_chans);<a class=headerlink href=#int-ast_bridge_mergestruct-ast_bridge-bridge_dest-struct-ast_bridge-bridge_src-struct-ast_channel-exclude_chans-int-num_chans title="Permanent link">&para;</a></h4> <ul> <li>Merge bridge_src into bridge_dest and kick out the channels specified by exclude_chans from the bridges. The bridge_src is gutted and may destroy itself.</li> <li>bridge_dest can be given new properties.</li> <li>Channel properties/roles may need to change.</li> <li>Channel driver attended transfers can be accomplished by merging bridges.</li> </ul> <p>This is likely only going to be used for local channel optimization. Unfortunately this will as a result be executed by the thread handling the media which would be not good. When local channel is given the go ahead, the local channels need to be suspended and the merge performed by another thread. A good thread would be one of the local channel bridge channels if it doesn't have much to do in its action queue. (Now do it on the bridge thread.)</p> <p>Switching to-from-native to 1-1 bridges is going to need to be done on a bridge channel thread as well. (Now do it on the bridge thread.)</p> <p>Always have a bridge thread. It will control the bridge restructuring, bridge tech selection, bridge hooks, and bridge timer hooks. The bridge thread will also do the bridge media handling depending upon the bridge tech. The early, native, and simple tech will use the bridge thread for media. The multiplexed bridge tech will pass the media duties to a thread common to several bridge instances. The softmix bridge uses the bridge thread for mixing the media after each bridge_channel thread has read it from the channel. Always having a bridge thread means it does not get created/destroyed when the bridge tech is changed by the smart bridge code.</p> <p>The bridge_dest needs to pull the channels from bridge_src for a merge/move. This will avoid the bridge ao2 reference problem if the bridge_src pushes the channels to bridge_dest.</p> <h4 id=int-ast_bridge_suspendstruct-ast_bridge-bridge-struct-ast_channel-chan>int ast_bridge_suspend(struct ast_bridge *bridge, struct ast_channel *chan);<a class=headerlink href=#int-ast_bridge_suspendstruct-ast_bridge-bridge-struct-ast_channel-chan title="Permanent link">&para;</a></h4> <h4 id=int-ast_bridge_unsuspendstruct-ast_bridge-bridge-struct-ast_channel-chan>int ast_bridge_unsuspend(struct ast_bridge *bridge, struct ast_channel *chan);<a class=headerlink href=#int-ast_bridge_unsuspendstruct-ast_bridge-bridge-struct-ast_channel-chan title="Permanent link">&para;</a></h4> <ul> <li>Peers of suspended channels need to act like autoserviced channels and save important frames like DTMF and control frames.</li> </ul> <h5 id=int-ast_is_deferrable_frameconst-struct-ast_frame-frame>int ast_is_deferrable_frame(const struct ast_frame *frame);<a class=headerlink href=#int-ast_is_deferrable_frameconst-struct-ast_frame-frame title="Permanent link">&para;</a></h5> <p>Those frames get sent to the suspended channel and put in its action queue. The bridge needs to generate silence frames to the peer while DTMF is being collected or the chan is suspended.</p> <p>The suspend/unsuspend functions by a third party should be removed. The bridging code mostly assumes that suspends are from the bridge channel thread and not an external party.</p> <h4 id=int-ast_bridge_count_channelsstruct-ast_bridge-bridge>int ast_bridge_count_channels(struct ast_bridge *bridge);<a class=headerlink href=#int-ast_bridge_count_channelsstruct-ast_bridge-bridge title="Permanent link">&para;</a></h4> <p>Return number of channels in the bridge.</p> <h4 id=struct-ast_channel-ast_bridge_peerstruct-ast_bridge-bridge-struct-ast_channel-chan>struct ast_channel *ast_bridge_peer(struct ast_bridge *bridge, struct ast_channel *chan);<a class=headerlink href=#struct-ast_channel-ast_bridge_peerstruct-ast_bridge-bridge-struct-ast_channel-chan title="Permanent link">&para;</a></h4> <p>Return the bridge peer channel of the given channel. The peer channel is returned with an increased ref count.</p> <p>This function feels dangerous.</p> <h4 id=int-ast_channel_is_bridgedstruct-ast_channel-chan>int ast_channel_is_bridged(struct ast_channel *chan);<a class=headerlink href=#int-ast_channel_is_bridgedstruct-ast_channel-chan title="Permanent link">&para;</a></h4> <p>Return TRUE if the channel is currently bridged.</p> <h4 id=struct-ast_bridge-ast_channel_get_bridgestruct-ast_channel-chan>struct ast_bridge *ast_channel_get_bridge(struct ast_channel *chan);<a class=headerlink href=#struct-ast_bridge-ast_channel_get_bridgestruct-ast_channel-chan title="Permanent link">&para;</a></h4> <p>Get the bridge the channel is currently in.</p> <h4 id=int-ast_bridge_play_to_chanstruct-ast_bridge-bridge-struct-ast_channel-chan-const-char-file>int ast_bridge_play_to_chan(struct ast_bridge *bridge, struct ast_channel *chan, const char *file);<a class=headerlink href=#int-ast_bridge_play_to_chanstruct-ast_bridge-bridge-struct-ast_channel-chan-const-char-file title="Permanent link">&para;</a></h4> <p>Play a file to the specified channel in a bridge. </p> <h4 id=int-ast_bridge_play_to_bridgestruct-ast_bridge-bridge-const-char-file>int ast_bridge_play_to_bridge(struct ast_bridge *bridge, const char *file);<a class=headerlink href=#int-ast_bridge_play_to_bridgestruct-ast_bridge-bridge-const-char-file title="Permanent link">&para;</a></h4> <p>Play a file to the specified bridge.</p> <h4 id=int-ast_bridge_transfer_blindstruct-ast_channel-transferrer-const-char-context-const-char-exten-int-priority>int ast_bridge_transfer_blind(struct ast_channel *transferrer, const char *context, const char *exten, int priority);<a class=headerlink href=#int-ast_bridge_transfer_blindstruct-ast_channel-transferrer-const-char-context-const-char-exten-int-priority title="Permanent link">&para;</a></h4> <ul> <li>The bridge peer of the transferrer channel is blind transferred.</li> <li>The bridge peer action runs ast_channel_transfer_blind() after UNHOLDing the channel. The target location is also checked for a Parking exten and a park is performed instead.</li> </ul> <h4 id=int-ast_channel_transfer_blindstruct-ast_channel-target-const-char-transferrer_chan_name-const-char-ctx_exten_pri>int ast_channel_transfer_blind(struct ast_channel *target, const char *transferrer_chan_name, const char *ctx_exten_pri);<a class=headerlink href=#int-ast_channel_transfer_blindstruct-ast_channel-target-const-char-transferrer_chan_name-const-char-ctx_exten_pri title="Permanent link">&para;</a></h4> <ul> <li> <p>The ctx_exten_pri is a parseable string: "[[context,]exten,]priority". The optional values are filled in by the target channel. transferrer_chan_name can be NULL if done anonymously.</p> </li> <li> <p>Set BLINDTRANSFER on target channel with transferer channel name. I don't see why it has historically been put on both channels since the Park app is who needs the variable set so it can announce the parking slot.</p> </li> <li>UNHOLD target.</li> <li>Post AMI blind transfer event.</li> <li>Do the ast_async_goto steps.</li> </ul> <h4 id=ast_async_goto>ast_async_goto()<a class=headerlink href=#ast_async_goto title="Permanent link">&para;</a></h4> <p>This function actually is a blind transfer!</p> <ul> <li>if channel in a bridge<ul> <li>if channel has a PBX<ul> <li>set PBX location on the channel + 1 because autoloop will decrement</li> </ul> </li> <li>else<ul> <li>set PBX location on the channel</li> </ul> </li> <li>set AST_SOFTHANGUP_ASYNCGOTO</li> </ul> </li> <li>else if channel has a PBX<ul> <li>set PBX location on the channel + 1 because autoloop will decrement</li> <li>set AST_SOFTHANGUP_ASYNCGOTO</li> </ul> </li> <li>else<ul> <li>create new channel</li> <li>set PBX location on the channel</li> <li>masquerade into it</li> </ul> </li> </ul> <h4 id=int-ast_bridge_transfer_attendedstruct-ast_channel-party_a-struct-ast_channel-party_c>int ast_bridge_transfer_attended(struct ast_channel *party_a, struct ast_channel *party_c);<a class=headerlink href=#int-ast_bridge_transfer_attendedstruct-ast_channel-party_a-struct-ast_channel-party_c title="Permanent link">&para;</a></h4> <ul> <li>UNHOLD target party_a peer.</li> <li>Post AMI attended transfer event.</li> <li>If party_a and party_c are in bridges, ast_bridge_merge() party_c bridge into party_a bridge removing party_a and party_c channels from the bridges.</li> <li>If one of the channels is not bridged then we'll have to do it the old way with masquerades.</li> <li>If neither of the channels are in bridges then return error.</li> </ul> <p>Problems if party_c is in the parking bridge. How to get party_a to take party_c's place in that bridge? Need an <code>ast_bridge_park(struct ast_bridge *parking_bridge, struct ast_bridge_channel *chan, struct ast_bridge_channel *swap);</code> The original party_a bridge is then dissolved.</p> <p>Problem is worse for ConfBridge. You cannot swap a channel into that bridge because ConfBridge maintains a lot of state outside of the bridge module. You can only masquerade into the ConfBridge.</p> <p>To eliminate the masquerade here it is likely that every application needs to become a mini channel driver attaching to a mini bridge associated with every channel. A radical rethink would be necessary for PBX and bridges.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>We'd really like to do that, but won't have time. </p> </div> <h4 id=int-ast_bridge_parkstruct-ast_bridge-parking_bridge-struct-ast_bridge_channel-chan-struct-ast_bridge_channel-swap>int ast_bridge_park(struct ast_bridge *parking_bridge, struct ast_bridge_channel *chan, struct ast_bridge_channel *swap);<a class=headerlink href=#int-ast_bridge_parkstruct-ast_bridge-parking_bridge-struct-ast_bridge_channel-chan-struct-ast_bridge_channel-swap title="Permanent link">&para;</a></h4> <p>Moves chan into the parking bridge and replaces the swap channel already in the bridge at the same parking space. This is a specialized ast_bridge_move().</p> <h3 id=features-and-other-thoughts>Features and other thoughts<a class=headerlink href=#features-and-other-thoughts title="Permanent link">&para;</a></h3> <h4 id=chan_agent-ideas>chan_agent ideas:<a class=headerlink href=#chan_agent-ideas title="Permanent link">&para;</a></h4> <ul> <li> <p>Agent logs in and waits for calls just like now. The agent could be placed into a holding bridge with some kind of monitoring for a caller.</p> </li> <li> <p>Calls come in and get put into a waiting call list container. These calls can abort if chan_agent is not configured to allow multiple waiting calls or if the agent is not logged in.</p> </li> <li> <p>Agent thread sees waiting call in the container and finds the early bridge the call is in. The agent can decide when to accept the call. The agent thread then does a Pickup of the incoming call by joining the early bridge.</p> </li> <li> <p>Incoming calls that are hungup by the caller or are canceled because the agent joined the early bridge are just removed from the waiting container.</p> </li> <li> <p>Agent channels that are blind transferred create a local channel to run dialplan at the specified location and joins the early bridge.</p> </li> </ul> <h4 id=colp-ideas>COLP ideas:<a class=headerlink href=#colp-ideas title="Permanent link">&para;</a></h4> <ul> <li> <p>COLP updates happen as an optional result of bridge enter/leave and merge events. Local channel optimizations do not request COLP updates when the bridges merge. Transfer merges do request COLP updates.</p> </li> <li> <p>Bridge join/impart new channel initiates a COLP update exchange if there are two peers or from the bridge COLP setting.</p> </li> <li> <p>A peer leaving a bridge causes a COLP update if two peers remain in the bridge.</p> </li> <li> <p>Multi-peer bridges should be given a COLP identity somehow that is user configurable. If none is given, then the bridge won't give any COLP updates when a new peer joins. The COLP could be assigned by an interception macro/gosub when the bridge goes multi-peer.</p> </li> <li> <p>COLP role flag for exchange/bridge updates.</p> </li> </ul> <h4 id=confbridge-colp-ideas>ConfBridge COLP ideas:<a class=headerlink href=#confbridge-colp-ideas title="Permanent link">&para;</a></h4> <ul> <li> <p>Marked users can give a bridge their COLP identity when they join. This could let peers know who is moderating the conference.</p> </li> <li> <p>Multi-marked users could cause COLP updates when they talk.</p> </li> <li> <p>The bridge profile used can give it a COLP identity and any COLP update</p> </li> </ul> <h4 id=parking-ideas>Parking ideas:<a class=headerlink href=#parking-ideas title="Permanent link">&para;</a></h4> <ul> <li>Add parking lot configuration option to give the parking lot a COLP identity.</li> </ul> <h4 id=add-new-channel-option>Add new CHANNEL() option:<a class=headerlink href=#add-new-channel-option title="Permanent link">&para;</a></h4> <p>CHANNEL(after_bridge_goto)=<parseable-goto> </p> <h4 id=bridgewait>BridgeWait()<a class=headerlink href=#bridgewait title="Permanent link">&para;</a></h4> <p>Potential new dialplan appliction that puts the channel into a holding bridge that the Bridge application or the Bridge AMI action can move to the real bridge. This will avoid the need for a masquerade when the Wait application is used. The Bridge applicaiton and Bridge AMI action will need to be modified to not use masquerades unconditionally if these channels can be moved from the current bridge they are in.</p> <h4 id=more-stuff>More Stuff<a class=headerlink href=#more-stuff title="Permanent link">&para;</a></h4> <p>The DTMF features could be a channel property datastore so they can be removed/restored to the channel depending upon which bridge they are in at the time. As a property they could be set by the CHANNEL() function.</p> <p>Two party bridges need to keep ast_channel_internal_bridged_channel_set() up to date with the peer.</p> <p>The default controlling channel for impromptu threeway bridges is the oldest channel controls the destruction of the bridge. A channel variable or CHANNEL(value) set by dialplan could be used to alter the bridge controller.</p> <p>It would be nice to implement DTMF attended transfer to be able to toggle back and forth between party A and C like DAHDI analog can do. </p> <p>Bridge channel hooks can move the bridge channel between bridges. This would be needed to implement the toggle between A and C bridges feature.</p> <p>A way to implement the toggle between A and C parties is to have an atxfer bridge subclass. Setup the links this way:</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a> A -- B1 --Local@special/b -- Batxfer1 -- B -- Batxfer2 -- Local@special/b -- B2 -- C
</span></code></pre></div> <p>The atxfer bridges grant B the transfer menu because it has the TransferrerRoll defined on the channel. When the transfer is completed, the TransferrerRoll is removed.</p> <p>The atxfer bridges have AST_BRIDGE_FLAG_MERGE_INHIBIT_TO set. They also have the inhibit merge count non-zero while the transfer is incomplete to prevent any local channel optimization.</p> <p>The only difference between a self managing bridge and an externally managed bridge is if there is something outside of the bridge referencing it. The bridge destructor posts the AMI bridge destroy event.</p> <p>Suspended channels can still be removed from a bridge. When they try to unsuspend, they find out if they are still part of the bridge or if it is still active.</p> <p>Non-native 1-1 bridges need to generate AST_CONTROL_SRCUPDATE frames.</p> <p>A channel that dissolves the bridge needs to update the peer channels hangup cause as it ejects them.</p> <p>Any channel that later tries to join a dissolved bridge will be immediately ejected with the cause code stored on the bridge.</p> <p>Event hooks are needed for the following type of events:</p> <ul> <li>bridge timeouts(bridge duration, interval),</li> <li>channel timeouts(duration, interval)<ul> <li>Since only the bridge is aware of time, channel timeouts are managed timeouts on the bridge. The enter/leave/merge code needs to update these channel timer hooks.]</li> </ul> </li> <li>channel DTMF features,</li> <li>channel enter/leave,</li> <li>bridge empty,</li> <li>bridge merge,</li> <li>bridge tech changes,</li> </ul> <p>The bridge channel needs to keep track of the last HOLD/UNHOLD state and any DTMF digit in progress so they can be stopped when the channel is removed from the bridge.</p> <p>The bridge_channel action queue will fix many of the issues I have been having with bridge member updates. The bridge core code determines which bridge_channel to put actions on from a feature hook. For example:</p> <ul> <li>Blind transfer hook triggers</li> <li>Hook gathers destination digits</li> <li>Hook validates destination</li> <li>Hook asks bridge core to post blind transfer action onto peer channel.</li> <li>Bridge may refuse if the request cannot be put onto a peer channel because it no longer exists or there is more than one.</li> <li>If the bridge refuses then the blind transfer fails and the hook just returns to the bridge as if the user did not try blind transfer. The queued action also needs a destructor as part of the queued struct.</li> </ul> <p>The bridge also needs an action queue to do things like smart bridge, bridge merges, channel join, and channel leave. COLP update action.</p> <h4 id=masquerades>Masquerades<a class=headerlink href=#masquerades title="Permanent link">&para;</a></h4> <p>Masquerades are used in two ways:</p> <ol type=1> <li>A third party has a channel that they want to take the place of an existing channel. Pickup, Local channel optimization, attended transfer with an application. Running an h exten on the zombie is a good thing.</li> <li>Steal a channel from some other thread. Park, bridging, blind transfers of channels without a PBX. Running an h exten on this zombie does not do much because it was a sacrificial channel anyway.</li> </ol> <h4 id=bridge-merging>Bridge Merging<a class=headerlink href=#bridge-merging title="Permanent link">&para;</a></h4> <p>Bridges can be marked as non-mergable. (Should be a non-mergable count to handle temporary merge blocks.)</p> <p>Maybe this should be done automatically while a bridge channel executes a bridge hook.</p> <ul> <li>This will block local channel optimizations until ready for it.</li> <li>This will prevent ConfBridge bridges from absorbing foreign bridges.</li> <li>This will prevent Parking bridges from absorbing foreign bridges.</li> </ul> <h4 id=bridge-event-hooks>Bridge Event Hooks<a class=headerlink href=#bridge-event-hooks title="Permanent link">&para;</a></h4> <p>Event hooks need to be able to be registered/unregistered/destroyed.</p> <p>Need to add to API: calls to register/unregister/destroy event observer callbacks with private pointer data.</p> <ul> <li>Channel bridge enter/exit - notify.</li> <li>Bridge technology change to/from specific technology - notify.</li> <li>Bridge stop/destroy hooks - notify.</li> <li>Bridge merge hooks to direct how merges transform the resulting bridge.<ul> <li>Pre-merge-veto - Multiple callbacks allowed. Any can veto merge.</li> <li>Pre-merge - Multiple callbacks allowed.</li> <li>Post-merge - Multiple callbacks allowed to inform of completed merge.</li> </ul> </li> <li>Bridge merge hooks per channel<ul> <li>Pre-merge-veto - Multiple callbacks allowed. Any can veto merge.</li> <li>Pre-merge - Multiple callbacks allowed.</li> <li>Post-merge - Multiple callbacks allowed to inform of completed merge.</li> </ul> </li> </ul> <h4 id=roles>Roles<a class=headerlink href=#roles title="Permanent link">&para;</a></h4> <p>Need to add role concepts for channels in bridge. Channels can change roles using feature hooks. Rolls may be flags.</p> <ul> <li>Caller/Callee for early media bridge and COLP interception macros.</li> <li>Announcer - Plays messages/music to channels in the bridge. Not considered a peer.</li> <li>Recorder - Records bridge. Not considered a peer.</li> <li>Agent - Can hear Supervisor whisper. Considered a peer. Only ability other than default.</li> <li>Supervisor - Can whisper to Agent. Not considered a peer.</li> <li>Default - Regular participant in the bridge. Considered a peer.</li> <li>ConfBridge - Regular participant in the bridge. Not considered a peer.</li> </ul> <p>Roll flags:</p> <ul> <li>Caller - Only significant in early media bridge. The caller flag can also be used for COLP interception macros. Attended transfers would need to manipulate the caller role flag for proper roles. Party A is always the caller role and Party C is the callee role.</li> <li>Peer - Normal bridges exchange control frames when only two channels are marked as peers. Early media bridges (if they but existed) also look at the Caller flag for control frame exchanges.</li> <li>COLP-exchange - Channel can exchange COLP updates with peer. Exchanges COLP when there are less than three channels in the bridge marked as such. Otherwise, it behaves like the COLP-bridge role flag.</li> <li>COLP-bridge - Channel can recieve COLP updates from the bridge. ConfBridge users just have this flag set to only receive COLP updates from the bridge.</li> </ul> <p>Future role flags (softmix bridge):</p> <ul> <li>Whisper - Channel can only be heard by a channel marked Whisper-receiver</li> <li>Whisper-receiver</li> <li>Recorder - Channel receives the recording mix of recordable channels.</li> <li>NonRecordable - Channel is not heard by a recording channel.</li> <li>Announcer - Channel can only be heard by a channel marked Announcer-receiver</li> <li>Announcer-receiver</li> </ul> <p>Recorder/Announcer channels need an option flag to exit the bridge if there is noone else in the bridge. Otherwise there is the possibility that the bridge will become orphaned with just those special channels in the bridge. AST_BRIDGE_FLAG_LONELY</p> <h3 id=new-objects>New Objects<a class=headerlink href=#new-objects title="Permanent link">&para;</a></h3> <h4 id=design-patterns>Design patterns<a class=headerlink href=#design-patterns title="Permanent link">&para;</a></h4> <ul> <li>The state pattern could be applied to ast_bridge.<ul> <li>ast_bridge could be thought of as a state of ast_bridge_channel.</li> <li>Changing states is moving to another bridge. This is a bit of a stretch though.</li> </ul> </li> </ul> <p>ast_bridge_technology is the strategy pattern</p> <p>The decorator pattern could be applied to ast_bridge_channel to decorate the channel with feature hooks. Decorators can be added/removed at run time just like features. Though this pattern may be a bit expensive resource wise.</p> <p>The Basic, Parking, ConfBridge, atxfer, and Queue bridges could be thought of as a strategy instead of subclassing ast_bridge_channel. It is looks more like ast_bridge_technology in relation to ast_bridge/ast_bridge_channel. Changed this back to just subclassing ast_bridge.</p> <h4 id=bridge-classes>Bridge Classes<a class=headerlink href=#bridge-classes title="Permanent link">&para;</a></h4> <p>Bridge technologies are an embedded object of the abstract bridge class.</p> <p>Park, Queue, ConfBridge could be derivative classes of the abstract bridge class.</p> <div class="language-text highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>class ast_bridge {
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a> join(struct ast_channel *chan);
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a> depart(struct ast_channel *chan);
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a> remove(struct ast_channel *chan);
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a> move_pull(class ast_bridge_channel *chan);
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a> Pull a channel out of this bridge to be pushed into another bridge.
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a> move_push(class ast_bridge_channel *chan, class ast_bridge_channel *swap);
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a> Push a channel into this bridge that was pulled from another bridge.
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a> masquerade_pull(class ast_bridge_channel *chan);
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a> A masquerade is figuratively pulling this channel out of the bridge
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a> to be pushed back in as a new channel.
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a> This is done for the clone and original channels because a masquerade
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a> swaps the guts of the two channels.
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a> masquerade_push(class ast_bridge_channel *chan);
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a> Push the channel back into the bridge as a new channel.
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a> poke();
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a> new();
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a> The derived bridge classes need to have a default channel
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a> configuration for when a channel is pushed into it.
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a> Park needs to assign a parking space and timeout.
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a> ConfBridge needs to have a default user profile.
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a> The class also needs to remove special channel configuration
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a> when it it pulled.
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a> The class needs to have a channel inherit the configuration
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a> of a swapped channel when it is pushed or joined.
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>};
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a>class ast_bridge_channel {
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a> class ast_bridge *bridge;
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a> suspend();
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a> Mark channel as suspended and poke the bridge to recognize it.
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a> unsuspend();
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a> Mark channel as unsuspended and poke the bridge to recognize it.
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a>};
</span></code></pre></div> <h4 id=locking-precedence-order>Locking precedence order:<a class=headerlink href=#locking-precedence-order title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a> bridges ao2_container
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a> |
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a> ast_bridge
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a> |
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a> channels ao2_container ast_bridge_channel
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a> | _____________/
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a> ast_channel
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a> /
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>channel private
</span></code></pre></div> <h4 id=new-bridge-techs>New Bridge Techs<a class=headerlink href=#new-bridge-techs title="Permanent link">&para;</a></h4> <h5 id=early-media-bridge-tech>Early media bridge tech:<a class=headerlink href=#early-media-bridge-tech title="Permanent link">&para;</a></h5> <ul> <li>Allowed channel roles: 0-1 Caller / 1-n Callees</li> <li>The bridge can start with this tech but cannot switch back to it.</li> <li>At most one Peer channel UP and at least one Peer channel not UP.</li> <li>Does not do audio mixing.</li> <li>First call to answer kicks out all other Peer non-Caller channels and answers the Caller channel if needed.</li> <li>The bridge tech needs to change to a normal bridge type.</li> <li>The bridge can have a timeout to connect.</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>We are, unfortunately, punting on the Early Media Bridge Technology. Not because it isn't awesome or the right way to do it, but because app_dial and app_queue are a bitch to refactor.</p> </div> <h5 id=parking-bridge-tech>Parking bridge tech:<a class=headerlink href=#parking-bridge-tech title="Permanent link">&para;</a></h5> <ul> <li>Adds ability to access bridge channels in it by parking space/slot.</li> <li>Parking bridges are found in a container by parking lot name.</li> <li>Parking lots can be configured with COLP information.</li> <li>The parking tech has extra methods to manage the parking lot:<ul> <li>move_bridged_channel_to_parking,</li> <li>move_bridged_channel_from_parking,</li> <li>swap_bridged_channel_with_parked</li> </ul> </li> <li>Actually these extra methods look like they should be part of the base bridge class.</li> <li>Timed out calls leave the parking lot by blind transfer.</li> </ul> <h4 id=dtmf-feature-transfers>DTMF Feature Transfers<a class=headerlink href=#dtmf-feature-transfers title="Permanent link">&para;</a></h4> <h5 id=dtmf-blind-transfer>DTMF Blind transfer:<a class=headerlink href=#dtmf-blind-transfer title="Permanent link">&para;</a></h5> <ul> <li>(Transfer will fail if the transferee channel is imparted to be departed.)</li> <li>Up non-merge count on host bridge.</li> <li>Get transfer destination.</li> <li>Validate it is in the dialplan.</li> <li>Check if it is a parking exten and park instead.</li> <li>Queue action to bridge peer to blind transfer.<ul> <li>Supply transfering channel, exten@context</li> </ul> </li> <li>Peer channel executes blind transfer action. ast_async_goto().<ul> <li>Channel leaves bridge and starts executing dialplan.</li> </ul> </li> <li>Drop non-merge count on host bridge.</li> </ul> <h5 id=dtmf-attended-transfer>DTMF Attended transfer:<a class=headerlink href=#dtmf-attended-transfer title="Permanent link">&para;</a></h5> <ul> <li>If party A hangs up the original bridge should be set to dissolve and automatically kick out party B from the bridge.</li> <li>Up non-merge count on host bridge.</li> <li>Get transfer destination.</li> <li>Validate it is in the dialplan.</li> <li>Check if it is a parking exten and park instead.</li> <li>Create early media bridge.<ul> <li>Bridge does not dissolve,</li> <li>Bridge times out,</li> <li>Bridge non-mergable(to prevent local channel optimization)</li> </ul> </li> <li>Dial party C</li> <li>Pull party B bridge_channel out of the bridge</li> <li>Create an atxfer caretaker thread to see it through. Pass party B bridge_channel, party C, and early media bridge<ul> <li>The early media bridge is not really viable here unless we want to allow it to be able to keep going with no caller.</li> <li>If party B hangs up before party C answers we need to save party B channel name, release party B channel, and wait the timeout for party C to answer</li> <li>If party C answers within the timeout then we can impart it into the original bridge to talk to party A.</li> <li>If party C does not answer within the timeout, we need to bounce back and forth call attempts to party B and party C.</li> </ul> </li> <li>Impart party C into early media bridge, Party C dissolves bridge when it hangs up.<ul> <li>If Party C is forwarded, the forwarded channel replaces the party C channel and takes Party C's properties.</li> </ul> </li> <li>Join party B into early media bridge (or not )</li> <li>Party B leaves the bridge when<ul> <li>early media bridge times out</li> <li>Party B cancels/aborts transfer</li> <li>Party B wishes threeway call</li> <li>Party B hangs up (early media bridge or normal bridge keeps going)</li> <li>Party C hangs up</li> </ul> </li> <li>if party B hangs up<ul> <li>if party C is up<ul> <li>Mark bridge channels as non-dissolving(Only party C should be in the bridge if still there)</li> <li>move Party C bridge channel to original bridge</li> <li>destroy temporary bridge</li> <li>Drop non-merge count on host bridge.</li> <li>party B returns to original bridge and leaves bridge</li> <li>done</li> </ul> </li> <li>wait for party C to answer or the timeout</li> </ul> </li> <li>else if party B cancels/aborts transfer<ul> <li>destroy temporary bridge</li> <li>Drop non-merge count on host bridge.</li> <li>party B returns to original bridge</li> <li>done</li> </ul> </li> <li>else if party B wishes threeway call<ul> <li>Mark bridge channels as non-dissolving(Only party C should be in the bridge if still there)</li> <li>mark party B on original bridge as dissolves bridge when it hangs up.</li> <li>mark original bridge as non-dissolving</li> <li>move Party C bridge channel to original bridge</li> <li>destroy temporary bridge</li> <li>Drop non-merge count on host bridge.</li> <li>party B returns to original bridge</li> <li>done</li> </ul> </li> <li>if early media bridge times out<ul> <li>If party C does not answer within the timeout, we need to bounce back and forth</li> <li>call attempts to party B and party C.</li> </ul> </li> </ul> <h5 id=parking-dtmf-one-touch-park-dtmf-blind-transfer-dtmf-attended-transfer>Parking (DTMF one-touch-park, DTMF blind transfer, DTMF attended transfer):<a class=headerlink href=#parking-dtmf-one-touch-park-dtmf-blind-transfer-dtmf-attended-transfer title="Permanent link">&para;</a></h5> <ul> <li>Determine parking lot to put peer into.</li> <li>Create parking space channel for masquerade.</li> <li>Reserve space in the parking lot.</li> <li>Queue action to bridge peer to park<ul> <li>Supply parking channel name, parking channel</li> </ul> </li> <li>Peer channel executes park-me action</li> <li>Park-me action queues play slot number or failure message back to peer</li> <li>Park-me action masquerades bridge_channel to parking channel.</li> <li>Parking channel is put into the parking manager thread.</li> </ul> <h5 id=pickup>Pickup:<a class=headerlink href=#pickup title="Permanent link">&para;</a></h5> <ul> <li>Find appropriate ringing channel in early media bridge</li> <li>Join-swap ringing channel</li> <li>Need some race condition insurance that some other channel won't win</li> <li>while the pickup channel is coming into the bridge. Otherwise we would</li> <li>wind up with a three or more party bridge.</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>This won't be how this works. It's still going to be a masquerade.</p> </div> <h5 id=local-channel-optimization>Local channel optimization:<a class=headerlink href=#local-channel-optimization title="Permanent link">&para;</a></h5> <ul> <li>Needs more thought because we don't want to optimize in the middle of other operations.</li> <li>Local channel determines it is possible to masquerade.</li> <li>The non-merge count will block optimizations during inopportune times.</li> <li>Optimization is done by merging bridges and ejecting the merging local channels from the resulting merged bridge.</li> </ul> <h5 id=followme>FollowMe:<a class=headerlink href=#followme title="Permanent link">&para;</a></h5> <ul> <li>For followme need an event-hook/frame-hook to intercept the AST_CONTROL_ANSWER so it can handle the user query. Each outgoing channel needs to have its own timer so it can drop out if it isn't answered. The main followme thread also has a timer to dump the next round of calls into the early-media bridge.</li> </ul> <h5 id=queue>Queue:<a class=headerlink href=#queue title="Permanent link">&para;</a></h5> <ul> <li>Like parking, the call can be stuck in a holding bridge until:<ol type=1> <li>an agent gets the call</li> <li>caller hangs up</li> <li>caller presses DTMF to goto new location</li> </ol> </li> <li>The holding bridge could periodically or when the number of calls ahead of the caller changes announce to the caller what position in the queue they are in.</li> </ul> <h3 id=apis-for-folks>APIs for Folks<a class=headerlink href=#apis-for-folks title="Permanent link">&para;</a></h3> <h4 id=cli-commands>CLI commands:<a class=headerlink href=#cli-commands title="Permanent link">&para;</a></h4> <div class="language-text highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>bridge show all
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a> List all current bridges by bridge-id and number of channels in the bridge.
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>bridge show bridge-id
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a> Dump information about the specified bridge.
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a> bridge-id, bridge tech using, bridge tech could use, channels in bridge,
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a> bridge type (normal, parking, queue, ConfBridge), other information
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>bridge destroy all
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a> Destroy all bridges in the system.
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a> Maybe we should qualify this as destroy only transient bridges. Not
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a> bridges that exist as long as the system is running or the module is loaded.
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a>bridge destroy bridge-id
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a> Destroy the specified bridge.
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a>
</span><span id=__span-4-17><a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a>bridge kick &lt;channel&gt;
</span><span id=__span-4-18><a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a> Kick a channel out of a bridge if it is in one.
</span><span id=__span-4-19><a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>
</span><span id=__span-4-20><a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a> NOTE: Be careful because it does not destroy the bridge. If there is only
</span><span id=__span-4-21><a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a> one channel left in the bridge, that channel may just sit there.
</span><span id=__span-4-22><a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>
</span><span id=__span-4-23><a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a>bridge suspend &lt;tech&gt;
</span><span id=__span-4-24><a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a> Suspend the bridge technology from use by bridges.
</span><span id=__span-4-25><a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a> Bridges currently using the technology will continue to use it.
</span><span id=__span-4-26><a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>
</span><span id=__span-4-27><a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a>bridge unsuspend &lt;tech&gt;
</span><span id=__span-4-28><a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a> Unsuspend the bridge technology from use by bridges.
</span></code></pre></div> <p>Corresponding AMI actions should also be created.</p> <h1 id=test-plan>Test Plan<a class=headerlink href=#test-plan title="Permanent link">&para;</a></h1> <p>Bridging has wide-ranging affects on a call. While each bridging test will have some aspect of bridging as its fundamental focus, each will also have common elements that are checked as well, independent of the primary purpose of the test. For example, even if the focus of the test is a feature such as Auto-Monitor, fundamental attributes such as CDRs should be checked for correctness as well.</p> <p>Tests need to be crafted not only to test the nominal path for features. For instance, it is not enough to write a transfer test wherein all parties behave as expected. There should be tests where a transfer is made to a non-existent extension, or a test where a transfer is started but an extension is not typed in within the appropriate time limit.</p> <p>See <a href=Asterisk-12-Bridging-Test-Plan>Asterisk 12 Bridging Test Plan</a> for mappings between the Asterisk tests and the defined Use Cases.</p> <h2 id=features-not-to-test>Features Not to Test<a class=headerlink href=#features-not-to-test title="Permanent link">&para;</a></h2> <p>There are some features and applications in Asterisk that, upon first glance, appear to be in the realm of a bridging test plan. Upon further inspection, however, they do not belong in the test plan.</p> <h3 id=bridge-manager-actionapplication>Bridge Manager Action/Application<a class=headerlink href=#bridge-manager-actionapplication title="Permanent link">&para;</a></h3> <p>These only represent different ways of erecting bridges between parties. They don't actually affect the operations and machinations of the bridge that gets created.</p> <h3 id=call-pickup>Call Pickup<a class=headerlink href=#call-pickup title="Permanent link">&para;</a></h3> <p>Call pickup occurs entirely before a bridge is formed, therefore it does not belong in a suite of bridge tests.</p> <div class="admonition note note"> <p class=admonition-title>Note</p> <p>This may actually change, if channels are placed into a new bridge technology that performs early media playback ("Early Bridge"). This would be advantageous as the channel picking up the call would simply join the bridge with the channel in early media, and the bridge technology would swap from the Early Bridge technology to a compatible Two-Party bridge technology.</p> <p>If that occurs, this test plan will be updated.</p> </div> <p>!!! note Note #2 Most likely, call pickup will not have an early bridge </p> <h3 id=invoking-bridges-from-multiple-applications>Invoking bridges from multiple applications<a class=headerlink href=#invoking-bridges-from-multiple-applications title="Permanent link">&para;</a></h3> <p>Since we're concerned with the operation of the actual bridge, it does not matter how the bridge gets invoked. Whether app_dial, app_queue, or app_followme is used to create the bridge, it makes no difference in the way the bridge ends up operating. This also means the various forms of call origination don't need to be tested, either.</p> <h2 id=common-elements-to-check-during-tests>Common elements to check during tests<a class=headerlink href=#common-elements-to-check-during-tests title="Permanent link">&para;</a></h2> <p>During all bridging tests, the bridge should be checked to make sure that media frames are being passed properly. The easiest way to do this is to pass DTMF between the two parties and ensure that they are received properly on the opposite side.</p> <p>The table below lists the items that should be checked in each test.</p> <table> <thead> <tr> <th>Item</th> <th>Rationale</th> </tr> </thead> <tbody> <tr> <td>CDRs</td> <td>The content of these will vary from test to test, but for common two-party bridges, these should be remarkably similar</td> </tr> <tr> <td>CELs</td> <td>Same applies for these as for CDRs</td> </tr> <tr> <td>CallerID</td> <td>Check that the Caller ID for each channel involved in the bridge is what it is expected to be</td> </tr> <tr> <td>Connected Line</td> <td>Check that connected line for each channel involved is what is expected</td> </tr> <tr> <td>Common Channel variables</td> <td>BRIDGEPEER, BRIDGEPVTCALLID should be set appropriately</td> </tr> <tr> <td>Bridge*</td> <td>Check that the AMI Bridge event occurs when expected</td> </tr> </tbody> </table> <h1 id=project-planning>Project Planning<a class=headerlink href=#project-planning title="Permanent link">&para;</a></h1> <h2 id=high-level-bridging-construction-tasks>High Level Bridging construction tasks:<a class=headerlink href=#high-level-bridging-construction-tasks title="Permanent link">&para;</a></h2> <ul> <li> <p><strong>DONE</strong> Change ast_bridge_call callers to not expect getting peer back. Part of this is to add an optional goto dialplan location datastore to set where the peer should go when it exits the bridge. The location datastore is removed if a channel exits with AST_SOFTHANGUP_ASYNCGOTO set or the channel is masqueraded. Part of this is to implement the self managing bridge functionality.</p> </li> <li> <p><strong>DONE</strong> Make all bridge technologies have a bridging thread to handle bridge restructuring tasks like smart bridge and bridge merges. When the bridge thread is not being used to restructure the</p> </li> <li> <p><strong>DONE</strong> Implement a v-method table to subclass struct ast_bridge. Parking, Queues, ConfBridge, and other holding bridges would then be able to subclass ast_bridge to allow merge/moves between bridges.</p> </li> <li> <p><strong>DONE</strong>(except for the role support in softmix. It won't be needed until much later if ever.): Add control frame support/processing. Part of this needs to add AST_CONTROL_SRCUPDATE generation on 1-1 bridging. Part of this needs to add the caller role flag for the initial role flags support. Mark normal channels with the peer role flag and respect it. Initially all channels not in a ConfBridge will be marked as a peer.</p> </li> <li> <p><strong>DONE</strong> Add bridge CLI commands. Part is to add bridge id support. How unique does the bridge id need to be? UUID, hostname/timestamp/sequence-no, timestamp/sequence-no, or just sequence-no AMI Transfer start/complete events. Implements the global bridges ao2 container. This container is needed for ConfBridge, Parking, BridgeWait, and Queue to find bridges by name. As a consequence of this, bridges must explicitly know when to die rather than counting on the ao2 reference count to drop to zero.</p> </li> <li> <p><strong>DONE</strong> Create the Basic bridge subclass. This bridge enables the DTMF features controlled by features.conf: One-touch-parking, Blind transfer, attended transfer, monitor-recording, mixmonitor-recording, dynamic features. The Basic bridge subclass pulls most of the code from ast_bridge_call into itself.</p> </li> <li> <p><strong>DONE</strong> Add bridge and bridge channel hooks for enter/leave/answer/merge/tech-change/empty events. An answer hook will not be usable until the early bridge is implemented.</p> </li> <li> <p><strong>DONE</strong> (save for complete) Add create/enter/leave/destroy bridge stasis/AMI events. The complete event is needed to indicate if the transfer was successful, aborted, or was turned into a threeway.</p> </li> <li> <p>Get local channel optimization functional again. I would like to pull chan_local into the bridging module. There seem to be times where it could be useful to create a local channel structure and impart the channels into different bridges or put one end into a bridge and the other executes an application. Pulling chal_local into the bridge module could wait until I actually have a real need to do so.</p> </li> <li> <p>Implement ast_bridge_transfer_blind() and ast_bridge_transfer_attended(). Attended transfer needs to update the caller role flags on peer channels. Attended transfer will need revisiting when parking is reworked.</p> </li> <li> <p>Get the channel drivers to use the ast_bridge_transfer_blind() and ast_bridge_transfer_attended() calls. This can be a task for each channel driver: chan_dahdi, chan_sip, chan_misdn, etc...</p> </li> <li> <p>Implement early bridging. I'm now thinking that the early media bridge will turn into just enhancing the dialing API because of the way Page works. Dial/Queue/FollowMe would need to be converted to use the dialing API.</p> </li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Punt.</p> </div> <ul> <li>Dial/Queue/FollowMe/Pickup updated to use early bridging.</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Punt.</p> </div> <ul> <li> <p>Get DTMF transfer features on par with current functionality. DTMF attended transfer will need a manager thread to handle operations after Party B hangs up and before Party C answers. Bonus is that the new bridging API allows threeway conferences. Since features.conf is being gutted should we eliminate it in favor of new config files?</p> </li> <li> <p>Implement parking bridge and get the system to use it. Park(), ParkedCall(), ParkAndAnnounce(), DTMF one touch park.</p> </li> <li> <p>Implement DTMF one touch record. Monitor and MixMonitor support.</p> </li> <li> <p>Get chan_agent working again since the chan-&gt;_bridge pointer is no more. Must be done after early bridging so the agent channel can Pickup the caller.</p> </li> <li> <p>Lastly native bridging technology.</p> </li> </ul> <h2 id=jira-issues>JIRA Issues<a class=headerlink href=#jira-issues title="Permanent link">&para;</a></h2> <p>true Contributors</p> <hr> <table> <thead> <tr> <th>Name</th> <th>E-mail Address</th> </tr> </thead> <tbody> <tr> <td>Matt Jordan</td> <td>mjordan@digium.com</td> </tr> <tr> <td>Richard Mudgett</td> <td>rmudgett@digium.com</td> </tr> <tr> <td>Jonathan Rose</td> <td>jrose@digium.com</td> </tr> </tbody> </table> <h1 id=reference-information>Reference Information<a class=headerlink href=#reference-information title="Permanent link">&para;</a></h1> <h2 id=test-reviews>Test Reviews<a class=headerlink href=#test-reviews title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th>Review</th> <th>Link</th> </tr> </thead> <tbody> <tr> <td>Bridging Test Suite Object</td> <td><a href=https://reviewboard.asterisk.org/r/2065/ >https://reviewboard.asterisk.org/r/2065/</a></td> </tr> <tr> <td>Timed Features Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2247/ >https://reviewboard.asterisk.org/r/2247/</a></td> </tr> <tr> <td>Connected Line Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2249/ >https://reviewboard.asterisk.org/r/2249/</a></td> </tr> <tr> <td>Auto-monitor, -mix-monitor, blind transfer detection; CDR/CEL integration Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2067/ >https://reviewboard.asterisk.org/r/2067/</a></td> </tr> <tr> <td>Auto-monitor, -mix-monitor basic Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2250/ >https://reviewboard.asterisk.org/r/2250/</a></td> </tr> <tr> <td>Call Parking (basic) Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2273/ >https://reviewboard.asterisk.org/r/2273/</a></td> </tr> <tr> <td>Call Parking Timeout (comebacktoorigin=yes) Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2306/ >https://reviewboard.asterisk.org/r/2306/</a></td> </tr> <tr> <td>Call Parking Timeout (comebacktoorigin=no) Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2301/ >https://reviewboard.asterisk.org/r/2301/</a></td> </tr> <tr> <td>Transfer Capability Tests</td> <td><a href=https://reviewboard.asterisk.org/r/2268/ >https://reviewboard.asterisk.org/r/2268/</a></td> </tr> </tbody> </table> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Content is licensed under a Creative Commons Attribution-ShareAlike 3.0 United States License. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://www.asterisk.org/ target=_blank rel=noopener title=www.asterisk.org class=md-social__link> <?xml version="1.0" encoding="UTF-8" standalone="no"?> <svg version=1.1 id=svg2 width=48 height=48 viewbox="0 0 48 48" sodipodi:docname=favicon.svg inkscape:version="1.2.2 (b0a8486541, 2022-12-01)" xmlns:inkscape=http://www.inkscape.org/namespaces/inkscape xmlns:sodipodi=http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd xmlns:xlink=http://www.w3.org/1999/xlink xmlns=http://www.w3.org/2000/svg xmlns:svg=http://www.w3.org/2000/svg> <defs id=defs6 /> <sodipodi:namedview id=namedview4 pagecolor=#ffffff bordercolor=#666666 borderopacity=1.0 inkscape:showpageshadow=2 inkscape:pageopacity=0.0 inkscape:pagecheckerboard=0 inkscape:deskcolor=#d1d1d1 showgrid=false inkscape:zoom=17.291667 inkscape:cx=24 inkscape:cy=24.028916 inkscape:current-layer=g8 /> <g inkscape:groupmode=layer inkscape:label=Image id=g8> <image width=48 height=48 preserveaspectratio=none id=image10 xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABHNCSVQICAgIfAhkiAAACzxJREFU
aIHtmXuQXNVxxn997jz3qRdasay0s5IMiQCDIx4JqaSwjQFDoGIXAhUVMAajgF0kAWShB48xDy2W
eLmoOLbsFBHGBahcgYTEBAJBhYNLxsjEWKEko6BdJCEJSWi1O7O7M3Pv+fLHvmZ3Z1YrYZJ/+Kqm
am6fPt393XNud5974RN8go8E+ziNK4s70HtSbTpWrCl5pdMxFy9FYdx8EBdRKBcrxeWLUUR/nyXz
M2q25S2LPxofHwuB/LLZzVEQnGXyp2HuJEythh0PTAXSoADMA33AIcFeEzvMsRVpc6RwU3377g/3
LW2qmfXAvvz/CQEJy9/ZcorC2DeccZ5gOtAAuEGVItIHODuIKCDiGNMMZgmSgzoeowuxXfgHEwrf
Kvj4tM3pztc/myX8WAgom0kVC35uyexWwxYLUkAXsB/pVx694nz0evchvdO87v3esfN33tySnl4T
P7XkdbEzLjXIAI2ASTwdmH8NXCxU6fGG9t0Hf6cE+pZnMnLc4I2vmDRDst/g+HeTXhXujdrVOz4w
0GTtHbxpfkO6rnSezK4GLhTEgP/00i9jxqySi+5uvHfXO78TAodXzr4gwD2CbJ4ZuyTucS58Mb2/
6QNbt7l0rHYF1n1zy9QgHVwH3A+GxFbQf5jZjND7r0+5/71Dx0xAS5tq8/H09Rh3I/I4Hi+GbvW0
b797+FiDrobcisxXZTxi0IB4E6MGaV3t6s6HzQZW9qgIdK84Ybpz8TsRfwG8JvRwXaLzZzbmAeu5
Y87JLuScclkEexra3/uXo/Gnm1vS+bS7A9wtCDD2AnUu4OKaezp+MWkCyuLyxZnHQc0PQJ8DvisV
1ta3791fmWjb9YHpO6OEppdr7+u85GgIAOz/m9bj0zX2b8CngSIQk/RKV390yeyHd/W5iSYruyBx
YNnxv0+xtQnSDwj+1MTq2kTnymrBAzgUCtKjfxO6qorjHunc46RvAR5IAM7MTm9IB+cO+Jog+Fx/
9zn1ybjrxe5CnOvEbTXJzvuHtowWEVRh0D/OnihUUt1QzUYZ0gc7n0O8WSaaGsjO3ZJdkKhKoKfQ
c7ZzwfxS6JYIFoM9uCNZ89hQqd9xTSaVn5/5cX757DM1ZivKa1ywJj+OVO+yE1ouOrH1sdzKzOkT
EbB1lDB+VCZyzrTwZLoaKhLov735pJhzWYNGjKtMPFV7sONvT8m+XQTQBoKZzdyGcYVc7Kd9y1u/
0Z1tnjFExAXjV8DKVkVLm2pzt2cu9LH4C8iuQjykZSfVT0SCyDZStorCTuwP4/XjCPSuap4d+sT3
Q29veLgS089rvLvN1jGc2/t+3bJQ6GuDpmZ4Z9+xYuKJ3hWtX9ySXZCotAJeFJTF5VZmTu9NpB/C
6yfAAgCZzuwN+i+vuiWBwHTYjD3DBMQs52O1owgouyAhxa8HjnfYCcIapdhyK8vxe5c21Uqx68Ca
y6Y6g/Nl9nim0LsWXGxsACYr9hdbrzH0E+A6sNrhMaxOZkt6P9U6sxoBn4qKEsMFDCNeME0ZRaC3
P3+ysK9JvI9pkTP9Q11i9tZynVQqNVPGn1TwYcB0jL8Cnq4wem2E/b2weWLcnRZwYmT8YTUCFJ1g
dL2Jex8ME3glS8w7uws4HlgIdIRR9JRlN46a1PjpzveiEtcKfiDK7shoNFaQNVTRLZnpX510XX3c
nq8Wv1nkGEijQ/De1DNMYGGh7SJDFw8oU2/GUw3tu/5nnKHLiRrXdGyqSxRvCUIuQnoJiKo5PgK2
Ofkrw3j0lXR75zOW7Rj38I8QCBJmTB26FnQHLuiJwUBLnCvqVrChvduH9L2hfqOiwez7vcCmHdnM
JTNLXANaKm9zMOJHCNpjfCDPBjNbXdP+3r7JMI28NRo0DV07o9Or2OsAevr8GQYnlbF7sXZ1555K
hsaiLdvRvzbesU5m92F0HUnfoCTPU3XJ4oq61TsmFfzgvLPKDj54z7a+eKrHCcwFdjYwbZiA16Sb
rt5VLSd8s9T6PcT9DJzCJoQgiXFtvph4Nr9q7hnSZBtKXVr2PxS8OY3tuRjZ5jRFOwUGlt5QGMHm
CU0J61naPD0ej1/gPXfLbO7kghiADTzQX5D8Wb23tz7auyq2Lh2fvWdswhhCftnsZmFfGAnAPowT
vWZZvMvl0nUSbcNj0JUm6qnmfOfNLenciszlLpl4IjJbf7TBj0GjZLd7hT/NF3f8dW5lW1NFrcDd
SFkGEnorlYw2A7ggSRIbeTgM6+2PBVWzyvRE4jhzuhM4H6tcOSul1wlSLmCnAN/Cc9rYkUPLMxlv
dnm5zBsPDSYRnFkYM1RX5iiZwldt8tLp1F7QP4HGkvSIvZJWx/CLKrBaH1q0GPQ2aOxWEfCqt+Ko
ratFBHHTZQatw1ThhcbVncP1whVCGWXdpMGU0AdVGyvLvl30LlgPtr3MfUHS0/LRFXXJtrsqz1Sy
8d6dG3xY+rLDHgTKM1CXl62rb9/9YfmM7nktbWBXM5R9xN5I/p5yHZcMgsiwkU5xQHnC9rb+nh2/
9Wjt4OU2c1xRl4zfUP/tna9admPosdTYOc5ImqGGNe9vS/fE7jKL/gzTSwwcVJ6vz8WeH/sGIwiC
OzFOHryMMJ48mHSjVikWxVWgyAFg3ojYLpNYX62QmSGp87H8qkyTC0s/qlmze1f5uPekbMwmlEZy
uD26vQC8sXdp05/XJVJft9D/2B7tGGmVlyyM52YcWILsqhGn2hqz4O/asu+OqtaxArHeBGGnwdll
7j7ftSpzGnT8VyUCQySgo73imBsJdkTfjVuVwdeGa8tl2kCQ+/WBSw27c+j2CQ47cVvqvnffGWvD
TWN7zqEtjO5nUgnpDi05YltQEX7g7dwoqIKsEnrebDvHZA8ijhsUlfAsr0l0Vmz0nGXxQpswjUpz
Mvtcbkbbl5Q9htO4B0wHyn+Sr3gmLkf/8nnzndOzDGQdA4USP+zrzj9R7a11DKCQSPwiWQx/A3y2
bGyKodvyxbatsOOto4k/puAlr/DKclnkNEEdGEAy1fd+WEi8jnEhgGHPOVdsn/nd/blqc4bTZ//y
OeeF5l7EynoTIWBLLIi+lLp357jW+uPAoW9mTo/H+WdgtozF9fd1jD8clWFUI5Vflfm+xHWMPzF1
4LmxNsXGiXr2o8GW7ILE3FJXEz7eYiX2Hqb/g6YH9vWSJegptC5zZnchfl6bLF48VHWPSKB31bzZ
XuF6ZOeOWokB7BPaIPFkfabzDftLjukFbtfyOVNjuLMxfR5nFyAWALsMvSzcKy4sbqQGfCH+jzI+
5cRXa9s7np0UAQk7vGLOHwSBPW2yeRX0/QARXpfX+vpU6YWJ7s6w3ZvmJ/saws8gfdnLzsdoYeBr
TXmCEJAD9gDPO2mXx9ZgPFnoid04/dHt3UckMITuFZnfc/CUGQtE9VRqKCfZLzH9Ssa7RHbQmfWZ
kYq8n2FmrZhOxWzhYFoc60+CHkPdhk0V1IzoyIM54LCz8Pya+3a9PmkCAIdubWuNJ3QLxtXAlGp6
HwH7kV6U7Dlc9N/ywRku4DOIUxk4Hc5icIUEz9QlOi6rlEonPA0p21zTU4ifFhirJLuwWvs8aQjh
+G0g1pfEM4UouXvGmm25oR7onZvmJ2fV0RAPCg3ybo6Hc4A/lnEm0uK61e+9fFQEhv0uIuib23q2
d9xg5v5IqNGgdrC6Vip03qCgga+QedA+sJ95Rc/UH9y5qfwt36T8Z8+N7c93zJi5tmPvMREoR25l
W5PwCyTmBsasSEwzsxpnCpArCfokuhzRPrDdMezdRH/YaQ/v6jtaX5PBR/rIJ7DNSxbGpjcfDDKH
Q6Mt5fmwJSK7MTqaj3uf4BP8P+J/ASVw7ffFYZkMAAAAAElFTkSuQmCC
"/> </g> </svg> </a> <a href=https://www.asterisk.org/blog/ target=_blank rel=noopener title=www.asterisk.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="m61.7 169.4 101.5 278C92.2 413 43.3 340.2 43.3 256c0-30.9 6.6-60.1 18.4-86.6m337.9 75.9c0-26.3-9.4-44.5-17.5-58.7-10.8-17.5-20.9-32.4-20.9-49.9 0-19.6 14.8-37.8 35.7-37.8.9 0 1.8.1 2.8.2-37.9-34.7-88.3-55.9-143.7-55.9-74.3 0-139.7 38.1-177.8 95.9 5 .2 9.7.3 13.7.3 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l77.5 230.4L249.8 247l-33.1-90.8c-11.5-.7-22.3-2-22.3-2-11.5-.7-10.1-18.2 1.3-17.5 0 0 35.1 2.7 56 2.7 22.2 0 56.7-2.7 56.7-2.7 11.5-.7 12.8 16.2 1.4 17.5 0 0-11.5 1.3-24.3 2l76.9 228.7 21.2-70.9c9-29.4 16-50.5 16-68.7m-139.9 29.3-63.8 185.5c19.1 5.6 39.2 8.7 60.1 8.7 24.8 0 48.5-4.3 70.6-12.1-.6-.9-1.1-1.9-1.5-2.9zm183-120.7c.9 6.8 1.4 14 1.4 21.9 0 21.6-4 45.8-16.2 76.2l-65 187.9C426.2 403 468.7 334.5 468.7 256c0-37-9.4-71.8-26-102.1M8 256a248 248 0 1 1 496 0 248 248 0 1 1-496 0m484.6 0a236.6 236.6 0 1 0-473.2 0 236.6 236.6 0 1 0 473.2 0"/></svg> </a> <a href=https://twitter.com/asteriskdev target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> <a href=https://github.com/asterisk target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://community.asterisk.org target=_blank rel=noopener title=community.asterisk.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9S348.6 32 225.9 32M224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.instant", "navigation.tracking", "navigation.prune", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.share", "content.code.copy", "content.code.annotate", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../../../assets/javascripts/bundle.92b07e13.min.js></script> </body> </html>